---
title: "Parent PLUS Report: Reproducible Analysis"
author: "Peter Granville"
date: 'May 26, 2022'
output: pdf_document
---

```{r setup, include=FALSE, echo=FALSE, warning=FALSE}
library(dplyr)
library(scales)
library(ggplot2)
library(reshape2)
library(data.table)

##################################################################
### The code you are reading was written to enable the reader  ###
### to easily determine the methodology for every piece of     ###
### original analysis in the accompanying report. Running the  ###
### R Markdown file as a PDF with the data files accessible    ###
### will recreate the text of the report and print out the     ###
### stats used in the report after making the calculations     ###
### from the data files, below the corresponding text.         ###
##################################################################

##################################################################
### The report also contains an analysis of SHED data. Please  ###
### refer to the file "Parent-Loans-SHED-May2022.Rmd" in the   ###
### GitHub repository for the code used for that analysis.     ###
##################################################################

##################################################################
### This analysis uses a number of data files that were too    ###
### large to store on GitHub, particularly files from IPEDS    ###
### and the College Scorecard. The data files from IPEDS used  ###
### here can be downloaded from the following site:            ###
### https://nces.ed.gov/ipeds/datacenter/DataFiles.aspx?gotoReportId=7&fromIpeds=true&
### The name of the .csv will always include the year and the  ###
### survey component, as well as whether a revised file is     ###
### used. The College Scorecard data used here reflects the    ###
### latest releases as of May 2022. The data files can be      ###
### downloaded from the following site: https://collegescorecard.ed.gov/data/
### Any other files used for this report can be found in the   ###
### GitHub repository for this project, found at the following ###
### link: https://github.com/PeterGranville/ParentPLUS-May2022 ###
##################################################################

##################################################################
### For any questions about this analysis, please email Peter  ###
### Granville at granville@tcf.org.                            ###
##################################################################
```

```{r FSA PLUS data, include=TRUE, echo=FALSE, warning=FALSE}

#################################################################
### This is a large chunk of code that loads in many files on ###
### PLUS loans from the FSA Data Center and creates a         ###
### dataframe with each year's PLUS disbursements and         ###
### recipients by institution. First we load the data         ###
### containing Parent PLUS disbursements by year.             ###
#################################################################

#################################################################
### These files all come from the following source:           ###
### https://studentaid.gov/data-center/student/title-iv       ###
### With each file, I turned the "award year" tab of the Q4   ###
### file into a CSV before loading it into R. In doing so, I  ###
### removed all columns that reflected programs other than    ###
### Parent PLUS. The resulting CSV files are in the GitHub    ###
### repository for this project.                              ###
#################################################################

#################################################################
### Until 2010, some Parent PLUS loans were disbursed through ###
### the FFEL program, as opposed to the Direct Loan program.  ###
### This is why we load some data sets reflecting DL and      ###
### others reflecting FFEL.                                   ### 
#################################################################

plus9900 <- fread("DL_AwardYr_Summary_AY1999_2000_All.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus0001 <- fread("DL_AwardYr_Summary_AY2000_2001_All.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus0102 <- fread("DL_AwardYr_Summary_AY2001_2002_All.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus0203 <- fread("DL_AwardYr_Summary_AY2002_2003_All.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus0304 <- fread("DL_AwardYr_Summary_AY2003_2004_All.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus0405 <- fread("DL_AwardYr_Summary_AY2004_2005_All.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus0506 <- fread("DL_AwardYr_Summary_AY2005_2006_All.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus0607 <- fread("DL_Dashboard_AY2006_2007_Q4.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus0708 <- fread("DL_Dashboard_AY2007_2008_Q4.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus0809 <- fread("DL_Dashboard_AY2008_2009_Q4.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus0910 <- fread("DL_Dashboard_AY2009_2010_Q4.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus1011 <- fread("DL_Dashboard_AY2010_2011_Q4.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus1112 <- fread("DL_Dashboard_AY2011_2012_Q4.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus1213 <- fread("DL_Dashboard_AY2012_2013_Q4.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus1314 <- fread("DL_Dashboard_AY2013_2014_Q4.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus1415 <- fread("DL_Dashboard_AY2014_2015_Q4.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus1516 <- fread("DL_Dashboard_AY2015_2016_Q4.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus1617 <- fread("DL_Dashboard_AY2016_2017_Q4.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus1718 <- fread("DL_Dashboard_AY2017_2018_Q4.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus1819 <- fread("dl-dashboard-ay2018-2019-q4.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus1920 <- fread("dl-dashboard-ay2019-2020-q4.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
plus2021 <- fread("dl-dashboard-ay2020-2021-q4.csv", header=TRUE) %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)

#################################################################
### Next we need to merge the data we just loaded with        ###
### FFEL data from 1999 to 2010. First we load the FFEL data. ###
#################################################################

ffel9900 <- fread("FFEL_AwardYr_Summary_AY1999_2000_All.csv", header=TRUE) %>% select(`OPE ID`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
ffel0001 <- fread("FFEL_AwardYr_Summary_AY2000_2001_All.csv", header=TRUE) %>% select(`OPE ID`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
ffel0102 <- fread("FFEL_AwardYr_Summary_AY2001_2002_All.csv", header=TRUE) %>% select(`OPE ID`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
ffel0203 <- fread("FFEL_AwardYr_Summary_AY2002_2003_All.csv", header=TRUE) %>% select(`OPE ID`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
ffel0304 <- fread("FFEL_AwardYr_Summary_AY2003_2004_All.csv", header=TRUE) %>% select(`OPE ID`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
ffel0405 <- fread("FFEL_AwardYr_Summary_AY2004_2005_All.csv", header=TRUE) %>% select(`OPE ID`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
ffel0506 <- fread("FFEL_AwardYr_Summary_AY2005_2006_All.csv", header=TRUE) %>% select(`OPE ID`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
ffel0607 <- fread("FL_Dashboard_AY2006_2007_Q4.csv", header=TRUE) %>% select(`OPE ID`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
ffel0708 <- fread("FL_Dashboard_AY2007_2008_Q4.csv", header=TRUE) %>% select(`OPE ID`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
ffel0809 <- fread("FL_Dashboard_AY2008_2009_Q4.csv", header=TRUE) %>% select(`OPE ID`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)
ffel0910 <- fread("FL_Dashboard_AY2009_2010_Q4.csv", header=TRUE) %>% select(`OPE ID`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)

#################################################################
### Next we add "DL" to the initial datasets to specify that  ###
### they are from the Direct Loan sets.                       ###
#################################################################

names(plus9900) <- c("OPE ID", "School", "State", "Zip Code", "School Type", "DL Recipients", "DL # of Loans Originated", "DL $ of Loans Originated", "DL # of Disbursements", "DL $ of Disbursements")
names(plus0001) <- c("OPE ID", "School", "State", "Zip Code", "School Type", "DL Recipients", "DL # of Loans Originated", "DL $ of Loans Originated", "DL # of Disbursements", "DL $ of Disbursements")
names(plus0102) <- c("OPE ID", "School", "State", "Zip Code", "School Type", "DL Recipients", "DL # of Loans Originated", "DL $ of Loans Originated", "DL # of Disbursements", "DL $ of Disbursements")
names(plus0203) <- c("OPE ID", "School", "State", "Zip Code", "School Type", "DL Recipients", "DL # of Loans Originated", "DL $ of Loans Originated", "DL # of Disbursements", "DL $ of Disbursements")
names(plus0304) <- c("OPE ID", "School", "State", "Zip Code", "School Type", "DL Recipients", "DL # of Loans Originated", "DL $ of Loans Originated", "DL # of Disbursements", "DL $ of Disbursements")
names(plus0405) <- c("OPE ID", "School", "State", "Zip Code", "School Type", "DL Recipients", "DL # of Loans Originated", "DL $ of Loans Originated", "DL # of Disbursements", "DL $ of Disbursements")
names(plus0506) <- c("OPE ID", "School", "State", "Zip Code", "School Type", "DL Recipients", "DL # of Loans Originated", "DL $ of Loans Originated", "DL # of Disbursements", "DL $ of Disbursements")
names(plus0607) <- c("OPE ID", "School", "State", "Zip Code", "School Type", "DL Recipients", "DL # of Loans Originated", "DL $ of Loans Originated", "DL # of Disbursements", "DL $ of Disbursements")
names(plus0708) <- c("OPE ID", "School", "State", "Zip Code", "School Type", "DL Recipients", "DL # of Loans Originated", "DL $ of Loans Originated", "DL # of Disbursements", "DL $ of Disbursements")
names(plus0809) <- c("OPE ID", "School", "State", "Zip Code", "School Type", "DL Recipients", "DL # of Loans Originated", "DL $ of Loans Originated", "DL # of Disbursements", "DL $ of Disbursements")
names(plus0910) <- c("OPE ID", "School", "State", "Zip Code", "School Type", "DL Recipients", "DL # of Loans Originated", "DL $ of Loans Originated", "DL # of Disbursements", "DL $ of Disbursements")

#################################################################
### Now we add "FFEL" to the new datasets to specify that     ###
### they are from the FFEL datasets.                          ###
#################################################################

names(ffel9900) <- c("OPE ID", "FFEL Recipients", "FFEL # of Loans Originated", "FFEL $ of Loans Originated", "FFEL # of Disbursements", "FFEL $ of Disbursements")
names(ffel0001) <- c("OPE ID", "FFEL Recipients", "FFEL # of Loans Originated", "FFEL $ of Loans Originated", "FFEL # of Disbursements", "FFEL $ of Disbursements")
names(ffel0102) <- c("OPE ID", "FFEL Recipients", "FFEL # of Loans Originated", "FFEL $ of Loans Originated", "FFEL # of Disbursements", "FFEL $ of Disbursements")
names(ffel0203) <- c("OPE ID", "FFEL Recipients", "FFEL # of Loans Originated", "FFEL $ of Loans Originated", "FFEL # of Disbursements", "FFEL $ of Disbursements")
names(ffel0304) <- c("OPE ID", "FFEL Recipients", "FFEL # of Loans Originated", "FFEL $ of Loans Originated", "FFEL # of Disbursements", "FFEL $ of Disbursements")
names(ffel0405) <- c("OPE ID", "FFEL Recipients", "FFEL # of Loans Originated", "FFEL $ of Loans Originated", "FFEL # of Disbursements", "FFEL $ of Disbursements")
names(ffel0506) <- c("OPE ID", "FFEL Recipients", "FFEL # of Loans Originated", "FFEL $ of Loans Originated", "FFEL # of Disbursements", "FFEL $ of Disbursements")
names(ffel0607) <- c("OPE ID", "FFEL Recipients", "FFEL # of Loans Originated", "FFEL $ of Loans Originated", "FFEL # of Disbursements", "FFEL $ of Disbursements")
names(ffel0708) <- c("OPE ID", "FFEL Recipients", "FFEL # of Loans Originated", "FFEL $ of Loans Originated", "FFEL # of Disbursements", "FFEL $ of Disbursements")
names(ffel0809) <- c("OPE ID", "FFEL Recipients", "FFEL # of Loans Originated", "FFEL $ of Loans Originated", "FFEL # of Disbursements", "FFEL $ of Disbursements")
names(ffel0910) <- c("OPE ID", "FFEL Recipients", "FFEL # of Loans Originated", "FFEL $ of Loans Originated", "FFEL # of Disbursements", "FFEL $ of Disbursements")

#################################################################
### Now we merge these datasets together.                     ###
#################################################################

plus9900 <- full_join(x=plus9900, y=ffel9900, by="OPE ID")
plus0001 <- full_join(x=plus0001, y=ffel0001, by="OPE ID")
plus0102 <- full_join(x=plus0102, y=ffel0102, by="OPE ID")
plus0203 <- full_join(x=plus0203, y=ffel0203, by="OPE ID")
plus0304 <- full_join(x=plus0304, y=ffel0304, by="OPE ID")
plus0405 <- full_join(x=plus0405, y=ffel0405, by="OPE ID")
plus0506 <- full_join(x=plus0506, y=ffel0506, by="OPE ID")
plus0607 <- full_join(x=plus0607, y=ffel0607, by="OPE ID")
plus0708 <- full_join(x=plus0708, y=ffel0708, by="OPE ID")
plus0809 <- full_join(x=plus0809, y=ffel0809, by="OPE ID")
plus0910 <- full_join(x=plus0910, y=ffel0910, by="OPE ID")

#################################################################
### Now we need to make sure that all the relevant variables  ###
### have no NA values.                                        ###
#################################################################

plus9900$`DL Recipients`[is.na(plus9900$`DL Recipients`)] <- 0
plus9900$`DL # of Loans Originated`[is.na(plus9900$`DL # of Loans Originated`)] <- 0
plus9900$`DL $ of Loans Originated`[is.na(plus9900$`DL $ of Loans Originated`)] <- 0
plus9900$`DL # of Disbursements`[is.na(plus9900$`DL # of Disbursements`)] <- 0
plus9900$`DL $ of Disbursements`[is.na(plus9900$`DL $ of Disbursements`)] <- 0
plus9900$`FFEL Recipients`[is.na(plus9900$`FFEL Recipients`)] <- 0
plus9900$`FFEL # of Loans Originated`[is.na(plus9900$`FFEL # of Loans Originated`)] <- 0
plus9900$`FFEL $ of Loans Originated`[is.na(plus9900$`FFEL $ of Loans Originated`)] <- 0
plus9900$`FFEL # of Disbursements`[is.na(plus9900$`FFEL # of Disbursements`)] <- 0
plus9900$`FFEL $ of Disbursements`[is.na(plus9900$`FFEL $ of Disbursements`)] <- 0

plus0001$`DL Recipients`[is.na(plus0001$`DL Recipients`)] <- 0
plus0001$`DL # of Loans Originated`[is.na(plus0001$`DL # of Loans Originated`)] <- 0
plus0001$`DL $ of Loans Originated`[is.na(plus0001$`DL $ of Loans Originated`)] <- 0
plus0001$`DL # of Disbursements`[is.na(plus0001$`DL # of Disbursements`)] <- 0
plus0001$`DL $ of Disbursements`[is.na(plus0001$`DL $ of Disbursements`)] <- 0
plus0001$`FFEL Recipients`[is.na(plus0001$`FFEL Recipients`)] <- 0
plus0001$`FFEL # of Loans Originated`[is.na(plus0001$`FFEL # of Loans Originated`)] <- 0
plus0001$`FFEL $ of Loans Originated`[is.na(plus0001$`FFEL $ of Loans Originated`)] <- 0
plus0001$`FFEL # of Disbursements`[is.na(plus0001$`FFEL # of Disbursements`)] <- 0
plus0001$`FFEL $ of Disbursements`[is.na(plus0001$`FFEL $ of Disbursements`)] <- 0

plus0102$`DL Recipients`[is.na(plus0102$`DL Recipients`)] <- 0
plus0102$`DL # of Loans Originated`[is.na(plus0102$`DL # of Loans Originated`)] <- 0
plus0102$`DL $ of Loans Originated`[is.na(plus0102$`DL $ of Loans Originated`)] <- 0
plus0102$`DL # of Disbursements`[is.na(plus0102$`DL # of Disbursements`)] <- 0
plus0102$`DL $ of Disbursements`[is.na(plus0102$`DL $ of Disbursements`)] <- 0
plus0102$`FFEL Recipients`[is.na(plus0102$`FFEL Recipients`)] <- 0
plus0102$`FFEL # of Loans Originated`[is.na(plus0102$`FFEL # of Loans Originated`)] <- 0
plus0102$`FFEL $ of Loans Originated`[is.na(plus0102$`FFEL $ of Loans Originated`)] <- 0
plus0102$`FFEL # of Disbursements`[is.na(plus0102$`FFEL # of Disbursements`)] <- 0
plus0102$`FFEL $ of Disbursements`[is.na(plus0102$`FFEL $ of Disbursements`)] <- 0

plus0203$`DL Recipients`[is.na(plus0203$`DL Recipients`)] <- 0
plus0203$`DL # of Loans Originated`[is.na(plus0203$`DL # of Loans Originated`)] <- 0
plus0203$`DL $ of Loans Originated`[is.na(plus0203$`DL $ of Loans Originated`)] <- 0
plus0203$`DL # of Disbursements`[is.na(plus0203$`DL # of Disbursements`)] <- 0
plus0203$`DL $ of Disbursements`[is.na(plus0203$`DL $ of Disbursements`)] <- 0
plus0203$`FFEL Recipients`[is.na(plus0203$`FFEL Recipients`)] <- 0
plus0203$`FFEL # of Loans Originated`[is.na(plus0203$`FFEL # of Loans Originated`)] <- 0
plus0203$`FFEL $ of Loans Originated`[is.na(plus0203$`FFEL $ of Loans Originated`)] <- 0
plus0203$`FFEL # of Disbursements`[is.na(plus0203$`FFEL # of Disbursements`)] <- 0
plus0203$`FFEL $ of Disbursements`[is.na(plus0203$`FFEL $ of Disbursements`)] <- 0

plus0304$`DL Recipients`[is.na(plus0304$`DL Recipients`)] <- 0
plus0304$`DL # of Loans Originated`[is.na(plus0304$`DL # of Loans Originated`)] <- 0
plus0304$`DL $ of Loans Originated`[is.na(plus0304$`DL $ of Loans Originated`)] <- 0
plus0304$`DL # of Disbursements`[is.na(plus0304$`DL # of Disbursements`)] <- 0
plus0304$`DL $ of Disbursements`[is.na(plus0304$`DL $ of Disbursements`)] <- 0
plus0304$`FFEL Recipients`[is.na(plus0304$`FFEL Recipients`)] <- 0
plus0304$`FFEL # of Loans Originated`[is.na(plus0304$`FFEL # of Loans Originated`)] <- 0
plus0304$`FFEL $ of Loans Originated`[is.na(plus0304$`FFEL $ of Loans Originated`)] <- 0
plus0304$`FFEL # of Disbursements`[is.na(plus0304$`FFEL # of Disbursements`)] <- 0
plus0304$`FFEL $ of Disbursements`[is.na(plus0304$`FFEL $ of Disbursements`)] <- 0

plus0405$`DL Recipients`[is.na(plus0405$`DL Recipients`)] <- 0
plus0405$`DL # of Loans Originated`[is.na(plus0405$`DL # of Loans Originated`)] <- 0
plus0405$`DL $ of Loans Originated`[is.na(plus0405$`DL $ of Loans Originated`)] <- 0
plus0405$`DL # of Disbursements`[is.na(plus0405$`DL # of Disbursements`)] <- 0
plus0405$`DL $ of Disbursements`[is.na(plus0405$`DL $ of Disbursements`)] <- 0
plus0405$`FFEL Recipients`[is.na(plus0405$`FFEL Recipients`)] <- 0
plus0405$`FFEL # of Loans Originated`[is.na(plus0405$`FFEL # of Loans Originated`)] <- 0
plus0405$`FFEL $ of Loans Originated`[is.na(plus0405$`FFEL $ of Loans Originated`)] <- 0
plus0405$`FFEL # of Disbursements`[is.na(plus0405$`FFEL # of Disbursements`)] <- 0
plus0405$`FFEL $ of Disbursements`[is.na(plus0405$`FFEL $ of Disbursements`)] <- 0

plus0506$`DL Recipients`[is.na(plus0506$`DL Recipients`)] <- 0
plus0506$`DL # of Loans Originated`[is.na(plus0506$`DL # of Loans Originated`)] <- 0
plus0506$`DL $ of Loans Originated`[is.na(plus0506$`DL $ of Loans Originated`)] <- 0
plus0506$`DL # of Disbursements`[is.na(plus0506$`DL # of Disbursements`)] <- 0
plus0506$`DL $ of Disbursements`[is.na(plus0506$`DL $ of Disbursements`)] <- 0
plus0506$`FFEL Recipients`[is.na(plus0506$`FFEL Recipients`)] <- 0
plus0506$`FFEL # of Loans Originated`[is.na(plus0506$`FFEL # of Loans Originated`)] <- 0
plus0506$`FFEL $ of Loans Originated`[is.na(plus0506$`FFEL $ of Loans Originated`)] <- 0
plus0506$`FFEL # of Disbursements`[is.na(plus0506$`FFEL # of Disbursements`)] <- 0
plus0506$`FFEL $ of Disbursements`[is.na(plus0506$`FFEL $ of Disbursements`)] <- 0

plus0607$`DL Recipients`[is.na(plus0607$`DL Recipients`)] <- 0
plus0607$`DL # of Loans Originated`[is.na(plus0607$`DL # of Loans Originated`)] <- 0
plus0607$`DL $ of Loans Originated`[is.na(plus0607$`DL $ of Loans Originated`)] <- 0
plus0607$`DL # of Disbursements`[is.na(plus0607$`DL # of Disbursements`)] <- 0
plus0607$`DL $ of Disbursements`[is.na(plus0607$`DL $ of Disbursements`)] <- 0
plus0607$`FFEL Recipients`[is.na(plus0607$`FFEL Recipients`)] <- 0
plus0607$`FFEL # of Loans Originated`[is.na(plus0607$`FFEL # of Loans Originated`)] <- 0
plus0607$`FFEL $ of Loans Originated`[is.na(plus0607$`FFEL $ of Loans Originated`)] <- 0
plus0607$`FFEL # of Disbursements`[is.na(plus0607$`FFEL # of Disbursements`)] <- 0
plus0607$`FFEL $ of Disbursements`[is.na(plus0607$`FFEL $ of Disbursements`)] <- 0

plus0708$`DL Recipients`[is.na(plus0708$`DL Recipients`)] <- 0
plus0708$`DL # of Loans Originated`[is.na(plus0708$`DL # of Loans Originated`)] <- 0
plus0708$`DL $ of Loans Originated`[is.na(plus0708$`DL $ of Loans Originated`)] <- 0
plus0708$`DL # of Disbursements`[is.na(plus0708$`DL # of Disbursements`)] <- 0
plus0708$`DL $ of Disbursements`[is.na(plus0708$`DL $ of Disbursements`)] <- 0
plus0708$`FFEL Recipients`[is.na(plus0708$`FFEL Recipients`)] <- 0
plus0708$`FFEL # of Loans Originated`[is.na(plus0708$`FFEL # of Loans Originated`)] <- 0
plus0708$`FFEL $ of Loans Originated`[is.na(plus0708$`FFEL $ of Loans Originated`)] <- 0
plus0708$`FFEL # of Disbursements`[is.na(plus0708$`FFEL # of Disbursements`)] <- 0
plus0708$`FFEL $ of Disbursements`[is.na(plus0708$`FFEL $ of Disbursements`)] <- 0

plus0809$`DL Recipients`[is.na(plus0809$`DL Recipients`)] <- 0
plus0809$`DL # of Loans Originated`[is.na(plus0809$`DL # of Loans Originated`)] <- 0
plus0809$`DL $ of Loans Originated`[is.na(plus0809$`DL $ of Loans Originated`)] <- 0
plus0809$`DL # of Disbursements`[is.na(plus0809$`DL # of Disbursements`)] <- 0
plus0809$`DL $ of Disbursements`[is.na(plus0809$`DL $ of Disbursements`)] <- 0
plus0809$`FFEL Recipients`[is.na(plus0809$`FFEL Recipients`)] <- 0
plus0809$`FFEL # of Loans Originated`[is.na(plus0809$`FFEL # of Loans Originated`)] <- 0
plus0809$`FFEL $ of Loans Originated`[is.na(plus0809$`FFEL $ of Loans Originated`)] <- 0
plus0809$`FFEL # of Disbursements`[is.na(plus0809$`FFEL # of Disbursements`)] <- 0
plus0809$`FFEL $ of Disbursements`[is.na(plus0809$`FFEL $ of Disbursements`)] <- 0

plus0910$`DL Recipients`[is.na(plus0910$`DL Recipients`)] <- 0
plus0910$`DL # of Loans Originated`[is.na(plus0910$`DL # of Loans Originated`)] <- 0
plus0910$`DL $ of Loans Originated`[is.na(plus0910$`DL $ of Loans Originated`)] <- 0
plus0910$`DL # of Disbursements`[is.na(plus0910$`DL # of Disbursements`)] <- 0
plus0910$`DL $ of Disbursements`[is.na(plus0910$`DL $ of Disbursements`)] <- 0
plus0910$`FFEL Recipients`[is.na(plus0910$`FFEL Recipients`)] <- 0
plus0910$`FFEL # of Loans Originated`[is.na(plus0910$`FFEL # of Loans Originated`)] <- 0
plus0910$`FFEL $ of Loans Originated`[is.na(plus0910$`FFEL $ of Loans Originated`)] <- 0
plus0910$`FFEL # of Disbursements`[is.na(plus0910$`FFEL # of Disbursements`)] <- 0
plus0910$`FFEL $ of Disbursements`[is.na(plus0910$`FFEL $ of Disbursements`)] <- 0

#################################################################
### Next we create the summed variables.                      ###
#################################################################

plus9900$`Recipients` <- plus9900$`DL Recipients` + plus9900$`FFEL Recipients`
plus9900$`# of Loans Originated` <- plus9900$`DL # of Loans Originated` + plus9900$`FFEL # of Loans Originated`
plus9900$`$ of Loans Originated` <- plus9900$`DL $ of Loans Originated` + plus9900$`FFEL $ of Loans Originated`
plus9900$`# of Disbursements` <- plus9900$`DL # of Disbursements` + plus9900$`FFEL # of Disbursements`
plus9900$`$ of Disbursements` <- plus9900$`DL $ of Disbursements` + plus9900$`FFEL $ of Disbursements`
plus9900 <- plus9900 %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)

plus0001$`Recipients` <- plus0001$`DL Recipients` + plus0001$`FFEL Recipients`
plus0001$`# of Loans Originated` <- plus0001$`DL # of Loans Originated` + plus0001$`FFEL # of Loans Originated`
plus0001$`$ of Loans Originated` <- plus0001$`DL $ of Loans Originated` + plus0001$`FFEL $ of Loans Originated`
plus0001$`# of Disbursements` <- plus0001$`DL # of Disbursements` + plus0001$`FFEL # of Disbursements`
plus0001$`$ of Disbursements` <- plus0001$`DL $ of Disbursements` + plus0001$`FFEL $ of Disbursements`
plus0001 <- plus0001 %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)

plus0102$`Recipients` <- plus0102$`DL Recipients` + plus0102$`FFEL Recipients`
plus0102$`# of Loans Originated` <- plus0102$`DL # of Loans Originated` + plus0102$`FFEL # of Loans Originated`
plus0102$`$ of Loans Originated` <- plus0102$`DL $ of Loans Originated` + plus0102$`FFEL $ of Loans Originated`
plus0102$`# of Disbursements` <- plus0102$`DL # of Disbursements` + plus0102$`FFEL # of Disbursements`
plus0102$`$ of Disbursements` <- plus0102$`DL $ of Disbursements` + plus0102$`FFEL $ of Disbursements`
plus0102 <- plus0102 %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)

plus0203$`Recipients` <- plus0203$`DL Recipients` + plus0203$`FFEL Recipients`
plus0203$`# of Loans Originated` <- plus0203$`DL # of Loans Originated` + plus0203$`FFEL # of Loans Originated`
plus0203$`$ of Loans Originated` <- plus0203$`DL $ of Loans Originated` + plus0203$`FFEL $ of Loans Originated`
plus0203$`# of Disbursements` <- plus0203$`DL # of Disbursements` + plus0203$`FFEL # of Disbursements`
plus0203$`$ of Disbursements` <- plus0203$`DL $ of Disbursements` + plus0203$`FFEL $ of Disbursements`
plus0203 <- plus0203 %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)

plus0304$`Recipients` <- plus0304$`DL Recipients` + plus0304$`FFEL Recipients`
plus0304$`# of Loans Originated` <- plus0304$`DL # of Loans Originated` + plus0304$`FFEL # of Loans Originated`
plus0304$`$ of Loans Originated` <- plus0304$`DL $ of Loans Originated` + plus0304$`FFEL $ of Loans Originated`
plus0304$`# of Disbursements` <- plus0304$`DL # of Disbursements` + plus0304$`FFEL # of Disbursements`
plus0304$`$ of Disbursements` <- plus0304$`DL $ of Disbursements` + plus0304$`FFEL $ of Disbursements`
plus0304 <- plus0304 %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)

plus0405$`Recipients` <- plus0405$`DL Recipients` + plus0405$`FFEL Recipients`
plus0405$`# of Loans Originated` <- plus0405$`DL # of Loans Originated` + plus0405$`FFEL # of Loans Originated`
plus0405$`$ of Loans Originated` <- plus0405$`DL $ of Loans Originated` + plus0405$`FFEL $ of Loans Originated`
plus0405$`# of Disbursements` <- plus0405$`DL # of Disbursements` + plus0405$`FFEL # of Disbursements`
plus0405$`$ of Disbursements` <- plus0405$`DL $ of Disbursements` + plus0405$`FFEL $ of Disbursements`
plus0405 <- plus0405 %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)

plus0506$`Recipients` <- plus0506$`DL Recipients` + plus0506$`FFEL Recipients`
plus0506$`# of Loans Originated` <- plus0506$`DL # of Loans Originated` + plus0506$`FFEL # of Loans Originated`
plus0506$`$ of Loans Originated` <- plus0506$`DL $ of Loans Originated` + plus0506$`FFEL $ of Loans Originated`
plus0506$`# of Disbursements` <- plus0506$`DL # of Disbursements` + plus0506$`FFEL # of Disbursements`
plus0506$`$ of Disbursements` <- plus0506$`DL $ of Disbursements` + plus0506$`FFEL $ of Disbursements`
plus0506 <- plus0506 %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)

plus0607$`Recipients` <- plus0607$`DL Recipients` + plus0607$`FFEL Recipients`
plus0607$`# of Loans Originated` <- plus0607$`DL # of Loans Originated` + plus0607$`FFEL # of Loans Originated`
plus0607$`$ of Loans Originated` <- plus0607$`DL $ of Loans Originated` + plus0607$`FFEL $ of Loans Originated`
plus0607$`# of Disbursements` <- plus0607$`DL # of Disbursements` + plus0607$`FFEL # of Disbursements`
plus0607$`$ of Disbursements` <- plus0607$`DL $ of Disbursements` + plus0607$`FFEL $ of Disbursements`
plus0607 <- plus0607 %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)

plus0708$`Recipients` <- plus0708$`DL Recipients` + plus0708$`FFEL Recipients`
plus0708$`# of Loans Originated` <- plus0708$`DL # of Loans Originated` + plus0708$`FFEL # of Loans Originated`
plus0708$`$ of Loans Originated` <- plus0708$`DL $ of Loans Originated` + plus0708$`FFEL $ of Loans Originated`
plus0708$`# of Disbursements` <- plus0708$`DL # of Disbursements` + plus0708$`FFEL # of Disbursements`
plus0708$`$ of Disbursements` <- plus0708$`DL $ of Disbursements` + plus0708$`FFEL $ of Disbursements`
plus0708 <- plus0708 %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)

plus0809$`Recipients` <- plus0809$`DL Recipients` + plus0809$`FFEL Recipients`
plus0809$`# of Loans Originated` <- plus0809$`DL # of Loans Originated` + plus0809$`FFEL # of Loans Originated`
plus0809$`$ of Loans Originated` <- plus0809$`DL $ of Loans Originated` + plus0809$`FFEL $ of Loans Originated`
plus0809$`# of Disbursements` <- plus0809$`DL # of Disbursements` + plus0809$`FFEL # of Disbursements`
plus0809$`$ of Disbursements` <- plus0809$`DL $ of Disbursements` + plus0809$`FFEL $ of Disbursements`
plus0809 <- plus0809 %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)

plus0910$`Recipients` <- plus0910$`DL Recipients` + plus0910$`FFEL Recipients`
plus0910$`# of Loans Originated` <- plus0910$`DL # of Loans Originated` + plus0910$`FFEL # of Loans Originated`
plus0910$`$ of Loans Originated` <- plus0910$`DL $ of Loans Originated` + plus0910$`FFEL $ of Loans Originated`
plus0910$`# of Disbursements` <- plus0910$`DL # of Disbursements` + plus0910$`FFEL # of Disbursements`
plus0910$`$ of Disbursements` <- plus0910$`DL $ of Disbursements` + plus0910$`FFEL $ of Disbursements`
plus0910 <- plus0910 %>% select(`OPE ID`, School, State, `Zip Code`, `School Type`, Recipients, `# of Loans Originated`, `$ of Loans Originated`, `# of Disbursements`, `$ of Disbursements`)

#################################################################
### Next we make the OPEID variable linkable with IPEDS data. ###
#################################################################

names(plus9900)[1] <- "OPEID"
names(plus0001)[1] <- "OPEID"
names(plus0102)[1] <- "OPEID"
names(plus0203)[1] <- "OPEID"
names(plus0304)[1] <- "OPEID"
names(plus0405)[1] <- "OPEID"
names(plus0506)[1] <- "OPEID"
names(plus0607)[1] <- "OPEID"
names(plus0708)[1] <- "OPEID"
names(plus0809)[1] <- "OPEID"
names(plus0910)[1] <- "OPEID"
names(plus1011)[1] <- "OPEID"
names(plus1112)[1] <- "OPEID"
names(plus1213)[1] <- "OPEID"
names(plus1314)[1] <- "OPEID"
names(plus1415)[1] <- "OPEID"
names(plus1516)[1] <- "OPEID"
names(plus1617)[1] <- "OPEID"
names(plus1718)[1] <- "OPEID"
names(plus1819)[1] <- "OPEID"
names(plus1920)[1] <- "OPEID"
names(plus2021)[1] <- "OPEID"

#################################################################
### Next we load in the IPEDS data on institutional           ###
### characteristics.                                          ###
#################################################################

hd9900 <- fread("ic99_hd.csv", header=TRUE, select=c("unitid", "instnm", "opeid", "sector", "control", "hbcu"))
names(hd9900) <- toupper(names(hd9900))
hd0001 <- fread("fa2000hd.csv", header=TRUE, select=c("unitid", "instnm", "opeid", "sector", "control", "hbcu"))
names(hd0001) <- toupper(names(hd0001))
hd0102 <- fread("fa2001hd.csv", header=TRUE, select=c("unitid", "instnm", "opeid", "sector", "control", "hbcu")) 
names(hd0102) <- toupper(names(hd0102))
hd0203 <- fread("hd2002.csv", header=TRUE, select=c("unitid", "instnm", "opeid", "sector", "control", "hbcu"))
names(hd0203) <- toupper(names(hd0203))
hd0304 <- fread("hd2003.csv", header=TRUE, select=c("unitid", "instnm", "opeid", "sector", "control", "hbcu"))
names(hd0304) <- toupper(names(hd0304))
hd0405 <- fread("hd2004.csv", header=TRUE, select=c("UNITID", "INSTNM", "OPEID", "SECTOR", "CONTROL", "HBCU"))
hd0506 <- fread("hd2005.csv", header=TRUE, select=c("UNITID", "INSTNM", "OPEID", "SECTOR", "CONTROL", "HBCU"))
hd0607 <- fread("hd2006.csv", header=TRUE, select=c("UNITID", "INSTNM", "OPEID", "SECTOR", "CONTROL", "HBCU"))
hd0708 <- fread("hd2007.csv", header=TRUE, select=c("UNITID", "INSTNM", "OPEID", "SECTOR", "CONTROL", "HBCU"))
hd0809 <- fread("hd2008.csv", header=TRUE, select=c("UNITID", "INSTNM", "OPEID", "SECTOR", "CONTROL", "HBCU"))
hd0910 <- fread("hd2009.csv", header=TRUE, select=c("unitid", "instnm", "opeid", "sector", "control", "hbcu"))
names(hd0910) <- toupper(names(hd0910))
hd1011 <- fread("hd2010.csv", header=TRUE, select=c("UNITID", "INSTNM", "OPEID", "SECTOR", "CONTROL", "HBCU"))
hd1112 <- fread("hd2011.csv", header=TRUE, select=c("UNITID", "INSTNM", "OPEID", "SECTOR", "CONTROL", "HBCU"))
hd1213 <- fread("hd2012.csv", header=TRUE, select=c("UNITID", "INSTNM", "OPEID", "SECTOR", "CONTROL", "HBCU"))
hd1314 <- fread("hd2013.csv", header=TRUE, select=c("UNITID", "INSTNM", "OPEID", "SECTOR", "CONTROL", "HBCU"))
hd1415 <- fread("hd2014.csv", header=TRUE, select=c("UNITID", "INSTNM", "OPEID", "SECTOR", "CONTROL", "HBCU"))
hd1516 <- fread("hd2015.csv", header=TRUE, select=c("UNITID", "INSTNM", "OPEID", "SECTOR", "CONTROL", "HBCU"))
hd1617 <- fread("hd2016.csv", header=TRUE, select=c("UNITID", "INSTNM", "OPEID", "SECTOR", "CONTROL", "HBCU"))
hd1718 <- fread("hd2017.csv", header=TRUE, select=c("UNITID", "INSTNM", "OPEID", "SECTOR", "CONTROL", "HBCU"))
hd1819 <- fread("hd2018.csv", header=TRUE, select=c("UNITID", "INSTNM", "OPEID", "SECTOR", "CONTROL", "HBCU"))
hd1920 <- fread("hd2019.csv", header=TRUE, select=c("UNITID", "INSTNM", "OPEID", "SECTOR", "CONTROL", "HBCU"))
hd2021 <- fread("hd2020.csv", header=TRUE, select=c("UNITID", "INSTNM", "OPEID", "SECTOR", "CONTROL", "HBCU"))

#################################################################
### Next we make sure the IPEDS files' OPEIDs are stored as   ###
### characters.                                               ###
#################################################################

plus9900$OPEID <- as.character(plus9900$OPEID)
plus0001$OPEID <- as.character(plus0001$OPEID)
plus0102$OPEID <- as.character(plus0102$OPEID)
plus0203$OPEID <- as.character(plus0203$OPEID)
plus0304$OPEID <- as.character(plus0304$OPEID)
plus0405$OPEID <- as.character(plus0405$OPEID)
plus0506$OPEID <- as.character(plus0506$OPEID)
plus0607$OPEID <- as.character(plus0607$OPEID)
plus0708$OPEID <- as.character(plus0708$OPEID)
plus0809$OPEID <- as.character(plus0809$OPEID)
plus0910$OPEID <- as.character(plus0910$OPEID)
plus1011$OPEID <- as.character(plus1011$OPEID)
plus1112$OPEID <- as.character(plus1112$OPEID)
plus1213$OPEID <- as.character(plus1213$OPEID)
plus1314$OPEID <- as.character(plus1314$OPEID)
plus1415$OPEID <- as.character(plus1415$OPEID)
plus1516$OPEID <- as.character(plus1516$OPEID)
plus1617$OPEID <- as.character(plus1617$OPEID)
plus1718$OPEID <- as.character(plus1718$OPEID)
plus1819$OPEID <- as.character(plus1819$OPEID)
plus1920$OPEID <- as.character(plus1920$OPEID)
plus2021$OPEID <- as.character(plus2021$OPEID)
hd9900$OPEID <- as.character(hd9900$OPEID)
hd0001$OPEID <- as.character(hd0001$OPEID)
hd0102$OPEID <- as.character(hd0102$OPEID)
hd0203$OPEID <- as.character(hd0203$OPEID)
hd0304$OPEID <- as.character(hd0304$OPEID)
hd0405$OPEID <- as.character(hd0405$OPEID)
hd0506$OPEID <- as.character(hd0506$OPEID)
hd0607$OPEID <- as.character(hd0607$OPEID)
hd0708$OPEID <- as.character(hd0708$OPEID)
hd0809$OPEID <- as.character(hd0809$OPEID)
hd0910$OPEID <- as.character(hd0910$OPEID)
hd1011$OPEID <- as.character(hd1011$OPEID)
hd1112$OPEID <- as.character(hd1112$OPEID)
hd1213$OPEID <- as.character(hd1213$OPEID)
hd1314$OPEID <- as.character(hd1314$OPEID)
hd1415$OPEID <- as.character(hd1415$OPEID)
hd1516$OPEID <- as.character(hd1516$OPEID)
hd1617$OPEID <- as.character(hd1617$OPEID)
hd1718$OPEID <- as.character(hd1718$OPEID)
hd1819$OPEID <- as.character(hd1819$OPEID)
hd1920$OPEID <- as.character(hd1920$OPEID)
hd2021$OPEID <- as.character(hd2021$OPEID)

#################################################################
### Next we add a 0 digit to any six-digit OPEIDs in the PLUS ###
### data.                                                     ###
#################################################################

plus9900$OPEID <- ifelse(nchar(plus9900$OPEID) == 6, paste("0", plus9900$OPEID, sep=""), plus9900$OPEID)
plus0001$OPEID <- ifelse(nchar(plus0001$OPEID) == 6, paste("0", plus0001$OPEID, sep=""), plus0001$OPEID)
plus0102$OPEID <- ifelse(nchar(plus0102$OPEID) == 6, paste("0", plus0102$OPEID, sep=""), plus0102$OPEID)
plus0203$OPEID <- ifelse(nchar(plus0203$OPEID) == 6, paste("0", plus0203$OPEID, sep=""), plus0203$OPEID)
plus0304$OPEID <- ifelse(nchar(plus0304$OPEID) == 6, paste("0", plus0304$OPEID, sep=""), plus0304$OPEID)
plus0405$OPEID <- ifelse(nchar(plus0405$OPEID) == 6, paste("0", plus0405$OPEID, sep=""), plus0405$OPEID)
plus0506$OPEID <- ifelse(nchar(plus0506$OPEID) == 6, paste("0", plus0506$OPEID, sep=""), plus0506$OPEID)
plus0607$OPEID <- ifelse(nchar(plus0607$OPEID) == 6, paste("0", plus0607$OPEID, sep=""), plus0607$OPEID)
plus0708$OPEID <- ifelse(nchar(plus0708$OPEID) == 6, paste("0", plus0708$OPEID, sep=""), plus0708$OPEID)
plus0809$OPEID <- ifelse(nchar(plus0809$OPEID) == 6, paste("0", plus0809$OPEID, sep=""), plus0809$OPEID)
plus0910$OPEID <- ifelse(nchar(plus0910$OPEID) == 6, paste("0", plus0910$OPEID, sep=""), plus0910$OPEID)
plus1011$OPEID <- ifelse(nchar(plus1011$OPEID) == 6, paste("0", plus1011$OPEID, sep=""), plus1011$OPEID)
plus1112$OPEID <- ifelse(nchar(plus1112$OPEID) == 6, paste("0", plus1112$OPEID, sep=""), plus1112$OPEID)
plus1213$OPEID <- ifelse(nchar(plus1213$OPEID) == 6, paste("0", plus1213$OPEID, sep=""), plus1213$OPEID)
plus1314$OPEID <- ifelse(nchar(plus1314$OPEID) == 6, paste("0", plus1314$OPEID, sep=""), plus1314$OPEID)
plus1415$OPEID <- ifelse(nchar(plus1415$OPEID) == 6, paste("0", plus1415$OPEID, sep=""), plus1415$OPEID)
plus1516$OPEID <- ifelse(nchar(plus1516$OPEID) == 6, paste("0", plus1516$OPEID, sep=""), plus1516$OPEID)
plus1617$OPEID <- ifelse(nchar(plus1617$OPEID) == 6, paste("0", plus1617$OPEID, sep=""), plus1617$OPEID)
plus1718$OPEID <- ifelse(nchar(plus1718$OPEID) == 6, paste("0", plus1718$OPEID, sep=""), plus1718$OPEID)
plus1819$OPEID <- ifelse(nchar(plus1819$OPEID) == 6, paste("0", plus1819$OPEID, sep=""), plus1819$OPEID)
plus1920$OPEID <- ifelse(nchar(plus1920$OPEID) == 6, paste("0", plus1920$OPEID, sep=""), plus1920$OPEID)
plus2021$OPEID <- ifelse(nchar(plus2021$OPEID) == 6, paste("0", plus2021$OPEID, sep=""), plus2021$OPEID)

#################################################################
### Next we add a 0 digit to any seven-digit OPEIDs in the    ###
### PLUS data.                                                ###
#################################################################

plus9900$OPEID <- ifelse(nchar(plus9900$OPEID) == 7, paste("0", plus9900$OPEID, sep=""), plus9900$OPEID)
plus0001$OPEID <- ifelse(nchar(plus0001$OPEID) == 7, paste("0", plus0001$OPEID, sep=""), plus0001$OPEID)
plus0102$OPEID <- ifelse(nchar(plus0102$OPEID) == 7, paste("0", plus0102$OPEID, sep=""), plus0102$OPEID)
plus0203$OPEID <- ifelse(nchar(plus0203$OPEID) == 7, paste("0", plus0203$OPEID, sep=""), plus0203$OPEID)
plus0304$OPEID <- ifelse(nchar(plus0304$OPEID) == 7, paste("0", plus0304$OPEID, sep=""), plus0304$OPEID)
plus0405$OPEID <- ifelse(nchar(plus0405$OPEID) == 7, paste("0", plus0405$OPEID, sep=""), plus0405$OPEID)
plus0506$OPEID <- ifelse(nchar(plus0506$OPEID) == 7, paste("0", plus0506$OPEID, sep=""), plus0506$OPEID)
plus0607$OPEID <- ifelse(nchar(plus0607$OPEID) == 7, paste("0", plus0607$OPEID, sep=""), plus0607$OPEID)
plus0708$OPEID <- ifelse(nchar(plus0708$OPEID) == 7, paste("0", plus0708$OPEID, sep=""), plus0708$OPEID)
plus0809$OPEID <- ifelse(nchar(plus0809$OPEID) == 7, paste("0", plus0809$OPEID, sep=""), plus0809$OPEID)
plus0910$OPEID <- ifelse(nchar(plus0910$OPEID) == 7, paste("0", plus0910$OPEID, sep=""), plus0910$OPEID)
plus1011$OPEID <- ifelse(nchar(plus1011$OPEID) == 7, paste("0", plus1011$OPEID, sep=""), plus1011$OPEID)
plus1112$OPEID <- ifelse(nchar(plus1112$OPEID) == 7, paste("0", plus1112$OPEID, sep=""), plus1112$OPEID)
plus1213$OPEID <- ifelse(nchar(plus1213$OPEID) == 7, paste("0", plus1213$OPEID, sep=""), plus1213$OPEID)
plus1314$OPEID <- ifelse(nchar(plus1314$OPEID) == 7, paste("0", plus1314$OPEID, sep=""), plus1314$OPEID)
plus1415$OPEID <- ifelse(nchar(plus1415$OPEID) == 7, paste("0", plus1415$OPEID, sep=""), plus1415$OPEID)
plus1516$OPEID <- ifelse(nchar(plus1516$OPEID) == 7, paste("0", plus1516$OPEID, sep=""), plus1516$OPEID)
plus1617$OPEID <- ifelse(nchar(plus1617$OPEID) == 7, paste("0", plus1617$OPEID, sep=""), plus1617$OPEID)
plus1718$OPEID <- ifelse(nchar(plus1718$OPEID) == 7, paste("0", plus1718$OPEID, sep=""), plus1718$OPEID)
plus1819$OPEID <- ifelse(nchar(plus1819$OPEID) == 7, paste("0", plus1819$OPEID, sep=""), plus1819$OPEID)
plus1920$OPEID <- ifelse(nchar(plus1920$OPEID) == 7, paste("0", plus1920$OPEID, sep=""), plus1920$OPEID)
plus2021$OPEID <- ifelse(nchar(plus2021$OPEID) == 7, paste("0", plus2021$OPEID, sep=""), plus2021$OPEID)

#################################################################
### Next we add a 0 digit to any six-digit OPEIDs in the      ###
### IPEDS data.                                               ###
#################################################################

hd1112$OPEID <- ifelse(nchar(hd1112$OPEID) == 6, paste("0", hd1112$OPEID, sep=""), hd1112$OPEID)
hd1213$OPEID <- ifelse(nchar(hd1213$OPEID) == 6, paste("0", hd1213$OPEID, sep=""), hd1213$OPEID)
hd1314$OPEID <- ifelse(nchar(hd1314$OPEID) == 6, paste("0", hd1314$OPEID, sep=""), hd1314$OPEID)
hd1415$OPEID <- ifelse(nchar(hd1415$OPEID) == 6, paste("0", hd1415$OPEID, sep=""), hd1415$OPEID)
hd1516$OPEID <- ifelse(nchar(hd1516$OPEID) == 6, paste("0", hd1516$OPEID, sep=""), hd1516$OPEID)
hd1819$OPEID <- ifelse(nchar(hd1819$OPEID) == 6, paste("0", hd1819$OPEID, sep=""), hd1819$OPEID)
hd1920$OPEID <- ifelse(nchar(hd1920$OPEID) == 6, paste("0", hd1920$OPEID, sep=""), hd1920$OPEID)
hd2021$OPEID <- ifelse(nchar(hd2021$OPEID) == 6, paste("0", hd2021$OPEID, sep=""), hd2021$OPEID)

#################################################################
### Next we add a 0 digit to any seven-digit OPEIDs in the    ###
### IPEDS data.                                               ###
#################################################################

hd1112$OPEID <- ifelse(nchar(hd1112$OPEID) == 7, paste("0", hd1112$OPEID, sep=""), hd1112$OPEID)
hd1213$OPEID <- ifelse(nchar(hd1213$OPEID) == 7, paste("0", hd1213$OPEID, sep=""), hd1213$OPEID)
hd1314$OPEID <- ifelse(nchar(hd1314$OPEID) == 7, paste("0", hd1314$OPEID, sep=""), hd1314$OPEID)
hd1415$OPEID <- ifelse(nchar(hd1415$OPEID) == 7, paste("0", hd1415$OPEID, sep=""), hd1415$OPEID)
hd1516$OPEID <- ifelse(nchar(hd1516$OPEID) == 7, paste("0", hd1516$OPEID, sep=""), hd1516$OPEID)
hd1819$OPEID <- ifelse(nchar(hd1819$OPEID) == 7, paste("0", hd1819$OPEID, sep=""), hd1819$OPEID)
hd1920$OPEID <- ifelse(nchar(hd1920$OPEID) == 7, paste("0", hd1920$OPEID, sep=""), hd1920$OPEID)
hd2021$OPEID <- ifelse(nchar(hd2021$OPEID) == 7, paste("0", hd2021$OPEID, sep=""), hd2021$OPEID)

#################################################################
### Now we join the IPEDS data to the PLUS data.              ###
#################################################################

data9900 <- left_join(x=plus9900, y=hd9900, by="OPEID")
data0001 <- left_join(x=plus0001, y=hd0001, by="OPEID")
data0102 <- left_join(x=plus0102, y=hd0102, by="OPEID")
data0203 <- left_join(x=plus0203, y=hd0203, by="OPEID")
data0304 <- left_join(x=plus0304, y=hd0304, by="OPEID")
data0405 <- left_join(x=plus0405, y=hd0405, by="OPEID")
data0506 <- left_join(x=plus0506, y=hd0506, by="OPEID")
data0607 <- left_join(x=plus0607, y=hd0607, by="OPEID")
data0708 <- left_join(x=plus0708, y=hd0708, by="OPEID")
data0809 <- left_join(x=plus0809, y=hd0809, by="OPEID")
data0910 <- left_join(x=plus0910, y=hd0910, by="OPEID")
data1011 <- left_join(x=plus1011, y=hd1011, by="OPEID")
data1112 <- left_join(x=plus1112, y=hd1112, by="OPEID")
data1213 <- left_join(x=plus1213, y=hd1213, by="OPEID")
data1314 <- left_join(x=plus1314, y=hd1314, by="OPEID")
data1415 <- left_join(x=plus1415, y=hd1415, by="OPEID")
data1516 <- left_join(x=plus1516, y=hd1516, by="OPEID")
data1617 <- left_join(x=plus1617, y=hd1617, by="OPEID")
data1718 <- left_join(x=plus1718, y=hd1718, by="OPEID")
data1819 <- left_join(x=plus1819, y=hd1819, by="OPEID")
data1920 <- left_join(x=plus1920, y=hd1920, by="OPEID")
data2021 <- left_join(x=plus2021, y=hd2021, by="OPEID")

##################################################################
### Now we load in the data on non-PLUS student financial aid. ###
### This data is available from 2008-09 onward.                ###
### UAGRNTT is the total amount of federal, state, local,      ###
### institutional or other sources of grant aid awarded to     ###
### undergraduate students. UFLOANT is the total amount of     ###
### federal student loans awarded to undergraduate students.   ###
### UFLOANT does not include Parent PLUS.                      ###
##################################################################

sfa09 <- fread("sfa0809_rv.csv", header=TRUE, select=c("UNITID", "UAGRNTT", "UFLOANT")) 
sfa10 <- fread("sfa0910_rv.csv", header=TRUE, select=c("UNITID", "UAGRNTT", "UFLOANT")) 
sfa11 <- fread("sfa1011_rv.csv", header=TRUE, select=c("UNITID", "UAGRNTT", "UFLOANT")) 
sfa12 <- fread("sfa1112_rv.csv", header=TRUE, select=c("UNITID", "UAGRNTT", "UFLOANT")) 
sfa13 <- fread("sfa1213_rv.csv", header=TRUE, select=c("UNITID", "UAGRNTT", "UFLOANT")) 
sfa14 <- fread("sfa1314_rv.csv", header=TRUE, select=c("UNITID", "UAGRNTT", "UFLOANT")) 
sfa15 <- fread("sfa1415_rv.csv", header=TRUE, select=c("UNITID", "UAGRNTT", "UFLOANT")) 
sfa16 <- fread("sfa1516_rv.csv", header=TRUE, select=c("UNITID", "UAGRNTT", "UFLOANT")) 
sfa17 <- fread("sfa1617_rv.csv", header=TRUE, select=c("UNITID", "UAGRNTT", "UFLOANT")) 
sfa18 <- fread("sfa1718_rv.csv", header=TRUE, select=c("UNITID", "UAGRNTT", "UFLOANT")) 
sfa19 <- fread("sfa1819_rv.csv", header=TRUE, select=c("UNITID", "UAGRNTT", "UFLOANT")) 
sfa20 <- fread("sfa1920.csv", header=TRUE, select=c("UNITID", "UAGRNTT", "UFLOANT"))  
sfa21 <- fread("sfa1920.csv", header=TRUE, select=c("UNITID", "UAGRNTT", "UFLOANT"))  # Imputing prior year data

opeid09 <- fread("hd2009.csv", header=TRUE, select=c("unitid", "opeid"))
names(opeid09) <- c("UNITID", "OPEID")
opeid10 <- fread("hd2010.csv", header=TRUE, select=c("UNITID", "OPEID"))
opeid11 <- fread("hd2011.csv", header=TRUE, select=c("UNITID", "OPEID"))
opeid12 <- fread("hd2012.csv", header=TRUE, select=c("UNITID", "OPEID"))
opeid13 <- fread("hd2013.csv", header=TRUE, select=c("UNITID", "OPEID"))
opeid14 <- fread("hd2014.csv", header=TRUE, select=c("UNITID", "OPEID"))
opeid15 <- fread("hd2015.csv", header=TRUE, select=c("UNITID", "OPEID"))
opeid16 <- fread("hd2016.csv", header=TRUE, select=c("UNITID", "OPEID"))
opeid17 <- fread("hd2017.csv", header=TRUE, select=c("UNITID", "OPEID"))
opeid18 <- fread("hd2018.csv", header=TRUE, select=c("UNITID", "OPEID"))
opeid19 <- fread("hd2019.csv", header=TRUE, select=c("UNITID", "OPEID"))
opeid20 <- fread("hd2020.csv", header=TRUE, select=c("UNITID", "OPEID"))
opeid21 <- fread("hd2020.csv", header=TRUE, select=c("UNITID", "OPEID")) # Imputing prior year data 

sfa09 <- right_join(x=opeid09, y=sfa09, by="UNITID")
sfa10 <- right_join(x=opeid10, y=sfa10, by="UNITID")
sfa11 <- right_join(x=opeid11, y=sfa11, by="UNITID")
sfa12 <- right_join(x=opeid12, y=sfa12, by="UNITID")
sfa13 <- right_join(x=opeid13, y=sfa13, by="UNITID")
sfa14 <- right_join(x=opeid14, y=sfa14, by="UNITID")
sfa15 <- right_join(x=opeid15, y=sfa15, by="UNITID")
sfa16 <- right_join(x=opeid16, y=sfa16, by="UNITID")
sfa17 <- right_join(x=opeid17, y=sfa17, by="UNITID")
sfa18 <- right_join(x=opeid18, y=sfa18, by="UNITID")
sfa19 <- right_join(x=opeid19, y=sfa19, by="UNITID")
sfa20 <- right_join(x=opeid20, y=sfa20, by="UNITID")
sfa21 <- right_join(x=opeid21, y=sfa21, by="UNITID")

##################################################################
### The FSA data is organized at the level of the OPEID, so we ###
### aggregate the IPEDS financial aid data by OPEID.           ###
##################################################################

sfa09 <- aggregate(data=sfa09, cbind(UAGRNTT, UFLOANT) ~ OPEID, FUN=sum)
names(sfa09) <- c("OPEID", "UAGRNTT", "UFLOANT")
sfa10 <- aggregate(data=sfa10, cbind(UAGRNTT, UFLOANT) ~ OPEID, FUN=sum)
names(sfa10) <- c("OPEID", "UAGRNTT", "UFLOANT")
sfa11 <- aggregate(data=sfa11, cbind(UAGRNTT, UFLOANT) ~ OPEID, FUN=sum)
sfa12 <- aggregate(data=sfa12, cbind(UAGRNTT, UFLOANT) ~ OPEID, FUN=sum)
sfa13 <- aggregate(data=sfa13, cbind(UAGRNTT, UFLOANT) ~ OPEID, FUN=sum)
sfa14 <- aggregate(data=sfa14, cbind(UAGRNTT, UFLOANT) ~ OPEID, FUN=sum)
sfa15 <- aggregate(data=sfa15, cbind(UAGRNTT, UFLOANT) ~ OPEID, FUN=sum)
sfa16 <- aggregate(data=sfa16, cbind(UAGRNTT, UFLOANT) ~ OPEID, FUN=sum)
sfa17 <- aggregate(data=sfa17, cbind(UAGRNTT, UFLOANT) ~ OPEID, FUN=sum)
sfa18 <- aggregate(data=sfa18, cbind(UAGRNTT, UFLOANT) ~ OPEID, FUN=sum)
sfa19 <- aggregate(data=sfa19, cbind(UAGRNTT, UFLOANT) ~ OPEID, FUN=sum)
sfa20 <- aggregate(data=sfa20, cbind(UAGRNTT, UFLOANT) ~ OPEID, FUN=sum)
sfa21 <- aggregate(data=sfa21, cbind(UAGRNTT, UFLOANT) ~ OPEID, FUN=sum)

sfa09$OPEID <- as.character(sfa09$OPEID)
sfa10$OPEID <- as.character(sfa10$OPEID)
sfa11$OPEID <- as.character(sfa11$OPEID)
sfa12$OPEID <- as.character(sfa12$OPEID)
sfa13$OPEID <- as.character(sfa13$OPEID)
sfa14$OPEID <- as.character(sfa14$OPEID)
sfa15$OPEID <- as.character(sfa15$OPEID)
sfa16$OPEID <- as.character(sfa16$OPEID)
sfa17$OPEID <- as.character(sfa17$OPEID)
sfa18$OPEID <- as.character(sfa18$OPEID)
sfa19$OPEID <- as.character(sfa19$OPEID)
sfa20$OPEID <- as.character(sfa20$OPEID)
sfa21$OPEID <- as.character(sfa21$OPEID)

sfa09$OPEID <- ifelse(nchar(sfa09$OPEID) == 6, paste("0", sfa09$OPEID, sep=""), sfa09$OPEID)
sfa10$OPEID <- ifelse(nchar(sfa10$OPEID) == 6, paste("0", sfa10$OPEID, sep=""), sfa10$OPEID)
sfa11$OPEID <- ifelse(nchar(sfa11$OPEID) == 6, paste("0", sfa11$OPEID, sep=""), sfa11$OPEID)
sfa12$OPEID <- ifelse(nchar(sfa12$OPEID) == 6, paste("0", sfa12$OPEID, sep=""), sfa12$OPEID)
sfa13$OPEID <- ifelse(nchar(sfa13$OPEID) == 6, paste("0", sfa13$OPEID, sep=""), sfa13$OPEID)
sfa14$OPEID <- ifelse(nchar(sfa14$OPEID) == 6, paste("0", sfa14$OPEID, sep=""), sfa14$OPEID)
sfa15$OPEID <- ifelse(nchar(sfa15$OPEID) == 6, paste("0", sfa15$OPEID, sep=""), sfa15$OPEID)
sfa16$OPEID <- ifelse(nchar(sfa16$OPEID) == 6, paste("0", sfa16$OPEID, sep=""), sfa16$OPEID)
sfa17$OPEID <- ifelse(nchar(sfa17$OPEID) == 6, paste("0", sfa17$OPEID, sep=""), sfa17$OPEID)
sfa18$OPEID <- ifelse(nchar(sfa18$OPEID) == 6, paste("0", sfa18$OPEID, sep=""), sfa18$OPEID)
sfa19$OPEID <- ifelse(nchar(sfa19$OPEID) == 6, paste("0", sfa19$OPEID, sep=""), sfa19$OPEID)
sfa20$OPEID <- ifelse(nchar(sfa20$OPEID) == 6, paste("0", sfa20$OPEID, sep=""), sfa20$OPEID)
sfa21$OPEID <- ifelse(nchar(sfa21$OPEID) == 6, paste("0", sfa21$OPEID, sep=""), sfa21$OPEID)

sfa09$OPEID <- ifelse(nchar(sfa09$OPEID) == 7, paste("0", sfa09$OPEID, sep=""), sfa09$OPEID)
sfa10$OPEID <- ifelse(nchar(sfa10$OPEID) == 7, paste("0", sfa10$OPEID, sep=""), sfa10$OPEID)
sfa11$OPEID <- ifelse(nchar(sfa11$OPEID) == 7, paste("0", sfa11$OPEID, sep=""), sfa11$OPEID)
sfa12$OPEID <- ifelse(nchar(sfa12$OPEID) == 7, paste("0", sfa12$OPEID, sep=""), sfa12$OPEID)
sfa13$OPEID <- ifelse(nchar(sfa13$OPEID) == 7, paste("0", sfa13$OPEID, sep=""), sfa13$OPEID)
sfa14$OPEID <- ifelse(nchar(sfa14$OPEID) == 7, paste("0", sfa14$OPEID, sep=""), sfa14$OPEID)
sfa15$OPEID <- ifelse(nchar(sfa15$OPEID) == 7, paste("0", sfa15$OPEID, sep=""), sfa15$OPEID)
sfa16$OPEID <- ifelse(nchar(sfa16$OPEID) == 7, paste("0", sfa16$OPEID, sep=""), sfa16$OPEID)
sfa17$OPEID <- ifelse(nchar(sfa17$OPEID) == 7, paste("0", sfa17$OPEID, sep=""), sfa17$OPEID)
sfa18$OPEID <- ifelse(nchar(sfa18$OPEID) == 7, paste("0", sfa18$OPEID, sep=""), sfa18$OPEID)
sfa19$OPEID <- ifelse(nchar(sfa19$OPEID) == 7, paste("0", sfa19$OPEID, sep=""), sfa19$OPEID)
sfa20$OPEID <- ifelse(nchar(sfa20$OPEID) == 7, paste("0", sfa20$OPEID, sep=""), sfa20$OPEID)
sfa21$OPEID <- ifelse(nchar(sfa21$OPEID) == 7, paste("0", sfa21$OPEID, sep=""), sfa21$OPEID)

#################################################################
### Next we merge the non-PLUS student financial aid data     ###
### into the rest of the data.                                ###
################################################################# 

data0809 <- left_join(x=data0809, y=sfa09, by="OPEID")
data0910 <- left_join(x=data0910, y=sfa10, by="OPEID")
data1011 <- left_join(x=data1011, y=sfa11, by="OPEID")
data1112 <- left_join(x=data1112, y=sfa12, by="OPEID")
data1213 <- left_join(x=data1213, y=sfa13, by="OPEID")
data1314 <- left_join(x=data1314, y=sfa14, by="OPEID")
data1415 <- left_join(x=data1415, y=sfa15, by="OPEID")
data1516 <- left_join(x=data1516, y=sfa16, by="OPEID")
data1617 <- left_join(x=data1617, y=sfa17, by="OPEID")
data1718 <- left_join(x=data1718, y=sfa18, by="OPEID")
data1819 <- left_join(x=data1819, y=sfa19, by="OPEID")
data1920 <- left_join(x=data1920, y=sfa20, by="OPEID")
data2021 <- left_join(x=data2021, y=sfa21, by="OPEID")

#################################################################
### Next we add NAs into the sets that lack student financial ###
### aid data (those from 1999-00 to 2007-08).                 ###
#################################################################

data9900$UAGRNTT <- rep(NA, nrow(data9900))
data0001$UAGRNTT <- rep(NA, nrow(data0001))
data0102$UAGRNTT <- rep(NA, nrow(data0102))
data0203$UAGRNTT <- rep(NA, nrow(data0203))
data0304$UAGRNTT <- rep(NA, nrow(data0304))
data0405$UAGRNTT <- rep(NA, nrow(data0405))
data0506$UAGRNTT <- rep(NA, nrow(data0506))
data0607$UAGRNTT <- rep(NA, nrow(data0607))
data0708$UAGRNTT <- rep(NA, nrow(data0708))

data9900$UFLOANT <- rep(NA, nrow(data9900))
data0001$UFLOANT <- rep(NA, nrow(data0001))
data0102$UFLOANT <- rep(NA, nrow(data0102))
data0203$UFLOANT <- rep(NA, nrow(data0203))
data0304$UFLOANT <- rep(NA, nrow(data0304))
data0405$UFLOANT <- rep(NA, nrow(data0405))
data0506$UFLOANT <- rep(NA, nrow(data0506))
data0607$UFLOANT <- rep(NA, nrow(data0607))
data0708$UFLOANT <- rep(NA, nrow(data0708))

#################################################################
### Now we add year labels to the data before merging them.   ###
#################################################################

data9900$Year <- rep("2000", nrow(data9900))
data0001$Year <- rep("2001", nrow(data0001))
data0102$Year <- rep("2002", nrow(data0102))
data0203$Year <- rep("2003", nrow(data0203))
data0304$Year <- rep("2004", nrow(data0304))
data0405$Year <- rep("2005", nrow(data0405))
data0506$Year <- rep("2006", nrow(data0506))
data0607$Year <- rep("2007", nrow(data0607))
data0708$Year <- rep("2008", nrow(data0708))
data0809$Year <- rep("2009", nrow(data0809))
data0910$Year <- rep("2010", nrow(data0910))
data1011$Year <- rep("2011", nrow(data1011))
data1112$Year <- rep("2012", nrow(data1112))
data1213$Year <- rep("2013", nrow(data1213))
data1314$Year <- rep("2014", nrow(data1314))
data1415$Year <- rep("2015", nrow(data1415))
data1516$Year <- rep("2016", nrow(data1516))
data1617$Year <- rep("2017", nrow(data1617))
data1718$Year <- rep("2018", nrow(data1718))
data1819$Year <- rep("2019", nrow(data1819))
data1920$Year <- rep("2020", nrow(data1920))
data2021$Year <- rep("2021", nrow(data2021))

#################################################################
### Now we merge all the data into one set.                   ###
#################################################################

allData <- rbind(data9900,
                 data0001,
                 data0102,
                 data0203,
                 data0304,
                 data0405,
                 data0506,
                 data0607,
                 data0708,
                 data0809,
                 data0910,
                 data1011,
                 data1112,
                 data1213,
                 data1314,
                 data1415,
                 data1516,
                 data1617,
                 data1718,
                 data1819,
                 data1920,
                 data2021)

#################################################################
### Now we need to ensure some columns are numeric.           ###
#################################################################

allData$`$ of Loans Originated` <- as.numeric(allData$`$ of Loans Originated`)
allData$`$ of Disbursements` <- as.numeric(allData$`$ of Disbursements`)
allData$`Recipients` <- as.numeric(allData$`Recipients`)
allData$`UAGRNTT` <- as.numeric(allData$`UAGRNTT`)
allData$`UFLOANT` <- as.numeric(allData$`UFLOANT`)

#################################################################
### Now we adjust for inflation. These are derived from       ###
### https://www.bls.gov/data/inflation_calculator.htm using   ###
### January of the comparison year and February 2022. (This   ###
### data analysis was conducted in March 2022.)               ###
#################################################################

allData$InflationMultiplier <- rep(NA, nrow(allData))
  allData$InflationMultiplier[allData$Year=="2000"] <- 1.68078
  allData$InflationMultiplier[allData$Year=="2001"] <- 1.62031
  allData$InflationMultiplier[allData$Year=="2002"] <- 1.60201
  allData$InflationMultiplier[allData$Year=="2003"] <- 1.56145
  allData$InflationMultiplier[allData$Year=="2004"] <- 1.53194
  allData$InflationMultiplier[allData$Year=="2005"] <- 1.48776
  allData$InflationMultiplier[allData$Year=="2006"] <- 1.43074
  allData$InflationMultiplier[allData$Year=="2007"] <- 1.40165
  allData$InflationMultiplier[allData$Year=="2008"] <- 1.34412
  allData$InflationMultiplier[allData$Year=="2009"] <- 1.34371
  allData$InflationMultiplier[allData$Year=="2010"] <- 1.30934
  allData$InflationMultiplier[allData$Year=="2011"] <- 1.28831
  allData$InflationMultiplier[allData$Year=="2012"] <- 1.25170
  allData$InflationMultiplier[allData$Year=="2013"] <- 1.23205
  allData$InflationMultiplier[allData$Year=="2014"] <- 1.21290
  allData$InflationMultiplier[allData$Year=="2015"] <- 1.21398
  allData$InflationMultiplier[allData$Year=="2016"] <- 1.19754
  allData$InflationMultiplier[allData$Year=="2017"] <- 1.16833
  allData$InflationMultiplier[allData$Year=="2018"] <- 1.14463
  allData$InflationMultiplier[allData$Year=="2019"] <- 1.12715
  allData$InflationMultiplier[allData$Year=="2020"] <- 1.09980
  allData$InflationMultiplier[allData$Year=="2021"] <- 1.08462
allData$InflationMultiplier <- as.numeric(allData$InflationMultiplier)

allData$`$ of Loans Originated` <- allData$`$ of Loans Originated` * allData$InflationMultiplier
allData$`$ of Disbursements` <- allData$`$ of Disbursements` * allData$InflationMultiplier
allData$`UAGRNTT` <- allData$`UAGRNTT` * allData$InflationMultiplier
allData$`UFLOANT` <- allData$`UFLOANT` * allData$InflationMultiplier

#################################################################
### The resulting dataset, allData, will be used later in     ###
### this Markdown document.                                   ###
#################################################################
```

## Executive Summary

As Americans’ collective federal student loan debt exceeds a trillion and a half dollars, it has captured the nation’s attention and spurred calls for forgiveness and reform. Last week, sources within the Biden administration indicated that the White House is finalizing plans to cancel $10,000 in federal student loan debt per borrower. This historic move will no doubt trigger nationwide debates about the merits of relieving student loan borrowers, who on average are younger and higher-income than other Americans, of their debts. Whether the public considers this move appropriate carries significant electoral implications.

But the public needs to know that not all student loan borrowers are young, college-educated, and on the rise in their careers. Some of them are retired. Some never enrolled in college at all. And these borrowers, though little discussed, might be among the most deserving of debt relief.

What the national discussion has mostly ignored is Parent PLUS borrowers, the more than 3.7 million families whose parents owe upward of $104 billion through a unique federal student loan program that they used to help pay for their children’s undergraduate educations. Parent PLUS loans differ from typical federal student loans in several key ways. The most obvious difference, of course, is that the people going into debt—parents—are not the ones receiving the benefits of an education. But less obvious is that the terms of these loans are less favorable for borrowers than those of other federal student loans for undergraduate education, and the options available to borrowers to reduce monthly payments, or to seek forgiveness of all or part of the debt, are less generous than for other federal student loans. This makes Parent PLUS loans one of the riskiest federal student loan options. 

```{r stat1, include=TRUE, echo=FALSE, warning=FALSE}
#################################################################
### First we load in the portfolio data and ensure that we    ###
### can tell which quarter is which. This file can be         ###
### downloaded from https://studentaid.gov/data-center/student/portfolio
#################################################################

portfolio <- read.csv("PortfoliobyLoanType.csv", header=TRUE)
portfolio$FiscalQuarter <- paste(portfolio$Federal.Fiscal.Year, portfolio$X, sep=" ")

##################################################################
### Next we format the numbers so that they are expressed in   ###
### $1 or 1 units, not $1,000,000,000 units or 1,000,000 units.###
##################################################################

portfolio$`Stafford Dollars` <- portfolio$Stafford.dollars * 1000000000
portfolio$`Grad PLUS Dollars` <- portfolio$Grad.PLUS.dollars * 1000000000
portfolio$`Parent PLUS Dollars` <- portfolio$Parent.PLUS.dollars * 1000000000
portfolio$`Perkins Dollars` <- portfolio$Parent.PLUS.dollars * 1000000000
portfolio$`Consolidation Dollars` <- portfolio$Consolidation.dollars * 1000000000

portfolio$`Stafford Recipients` <- portfolio$Stafford.recipients * 1000000
portfolio$`Grad PLUS Recipients` <- portfolio$Grad.PLUS.recipients * 1000000
portfolio$`Parent PLUS Recipients` <- portfolio$Parent.PLUS.recipients * 1000000
portfolio$`Perkins Recipients` <- portfolio$Parent.PLUS.recipients * 1000000
portfolio$`Consolidation Recipients` <- portfolio$Consolidation.recipients * 1000000

paste("The current outstanding balance of Parent PLUS loans is roughly", dollar(portfolio$`Parent PLUS Dollars`[portfolio$Federal.Fiscal.Year=="2022" & portfolio$X=="Q1"])) 
```

```{r stat2, include=TRUE, echo=FALSE, warning=FALSE}
paste("The number of outstanding Parent PLUS loans is roughly", format(portfolio$`Parent PLUS Recipients`[portfolio$Federal.Fiscal.Year=="2022" & portfolio$X=="Q1"], big.mark=","))
```

Furthermore, Parent PLUS loan amounts skew high compared to those for other student loans for undergraduate study, and data show that parents often struggle to repay. When a student whose parent(s) borrowed completes their program, the median Parent PLUS debt load shouldered by their parents is roughly $29,600. After ten years—the length of the standard Parent PLUS repayment plan—more than half of the initial balance (55 percent) still remains, on average, because parent-borrowers have trouble maintaining the repayment schedule; after twenty years, the remaining balance is still a whopping 38 percent. In other words, many parents spend more years paying off their Parent PLUS loans than the years they spent living with and raising the child whose education their loan supported. 

```{r stat3, include=TRUE, echo=FALSE, warning=FALSE}

###################################################################
### First we load in variables from the College Scorecard       ###
### Institution dataset. These reflect dollar-based repayment   ###
### data for cohorts that began repayment a certain number of   ###
### years ago, in this case 10 and 20 years ago.                ###
###################################################################

CSI14 <- fread("Most-Recent-Cohorts-Institution.csv", header=TRUE, select=c(
  "UNITID",                   # Unit ID for institution
  "OPEID6",                   # 6-digit OPE ID for institution
  "PLUS_DEBT_INST_COMP_N",    # Student recipient count for median PLUS loan debt disbursed to completers at this institution
  "PLUS_DEBT_INST_COMP_MD",   # Median PLUS loan debt disbursed to completers at this institution
  "DBRR10_PP_UG_N",           # Undergraduate Parent PLUS Loan dollar-based 10-year repayment rate borrower count
  "DBRR10_PP_UG_NUM",         # Undergraduate Parent PLUS Loan dollar-based 10-year repayment rate numerator
  "DBRR10_PP_UG_DEN",         # Undergraduate Parent PLUS Loan dollar-based 10-year repayment rate denominator
  "DBRR20_PP_UG_N",           # Undergraduate Parent PLUS Loan dollar-based 20-year repayment rate borrower count
  "DBRR20_PP_UG_NUM",         # Undergraduate Parent PLUS Loan dollar-based 20-year repayment rate numerator
  "DBRR20_PP_UG_DEN"          # Undergraduate Parent PLUS Loan dollar-based 20-year repayment rate denominator
)) %>% filter(duplicated(OPEID6)==FALSE) # This filtering is necessary because otherwise debt amounts may be double-counted. 

CSI14$DBRR10_PP_UG_N <- as.numeric(CSI14$DBRR10_PP_UG_N)
CSI14$DBRR10_PP_UG_NUM <- as.numeric(CSI14$DBRR10_PP_UG_NUM)
CSI14$DBRR10_PP_UG_DEN <- as.numeric(CSI14$DBRR10_PP_UG_DEN)

CSI14$DBRR20_PP_UG_N <- as.numeric(CSI14$DBRR20_PP_UG_N)
CSI14$DBRR20_PP_UG_NUM <- as.numeric(CSI14$DBRR20_PP_UG_NUM)
CSI14$DBRR20_PP_UG_DEN <- as.numeric(CSI14$DBRR20_PP_UG_DEN)

CSI14$PLUS_DEBT_INST_COMP_N <- as.numeric(CSI14$PLUS_DEBT_INST_COMP_N)
CSI14$PLUS_DEBT_INST_COMP_MD <- as.numeric(CSI14$PLUS_DEBT_INST_COMP_MD)

#################################################################
### We're looking now for the median PLUS load for completers.###
### The data are already reported in institutional medians.   ###
### We calculate a weighted average across all institutions.  ###
#################################################################

CSI14.1 <- CSI14 %>% filter(is.na(PLUS_DEBT_INST_COMP_N)==FALSE
                            &
                            is.na(PLUS_DEBT_INST_COMP_MD)==FALSE)

CSI14.1$`Share of all PLUS completers` <- CSI14.1$PLUS_DEBT_INST_COMP_N / sum(CSI14.1$PLUS_DEBT_INST_COMP_N, na.rm=TRUE)
CSI14.1$`Median times share` <- CSI14.1$PLUS_DEBT_INST_COMP_MD * CSI14.1$`Share of all PLUS completers`

paste("The median Parent PLUS load at completion is roughly", dollar(round(sum(CSI14.1$`Median times share`), digits=-2))) 
```

```{r stat4, include=TRUE, echo=FALSE, warning=FALSE}
#################################################################
### To now calculate the repayment rate 10 years into         ###
### repayment, we divide the sum of balances by the sum of    ###
### original principal, aggregated across all institutions    ###
### for which we have sufficient data.                        ###
#################################################################

CSI14.2 <- CSI14 %>% filter(is.na(DBRR10_PP_UG_NUM)==FALSE
                            &
                            is.na(DBRR10_PP_UG_DEN)==FALSE)
paste("After 10 years, the percent of Parent PLUS principal remaining is", percent(sum(CSI14.2$DBRR10_PP_UG_NUM) / sum(CSI14.2$DBRR10_PP_UG_DEN), accuracy=0.1)) 
```

```{r stat5, include=TRUE, echo=FALSE, warning=FALSE}
#################################################################
### We do the same thing here for 20 years into repayment.    ###
#################################################################

CSI14.3 <- CSI14 %>% filter(is.na(DBRR20_PP_UG_NUM)==FALSE
                            &
                            is.na(DBRR20_PP_UG_DEN)==FALSE)
paste("After 20 years, the percent of Parent PLUS principal remaining is", percent(sum(CSI14.3$DBRR20_PP_UG_NUM) / sum(CSI14.3$DBRR20_PP_UG_DEN), accuracy=0.1)) 
```

The most vulnerable Parent PLUS borrowers, if they cannot repay, may even see their access to basic subsistence cut off. In 2015, 40,000 disabled or retired Parent PLUS borrowers saw portions of their Social Security benefits withheld from them after defaulting on their loans. 

This report provides new analyses from a range of data sources to understand how Parent PLUS has morphed from a niche program for middle-class families into a driving cause of some of the worst outcomes for families who receive federal student loans, and especially for Black families. Our analysis reveals the following: 

* The share of Black Parent PLUS borrowers whose families have so little wealth or income that their expected family contribution (EFC) to a college education (as calculated by the U.S. Department of Education) is zero rose from 15 percent in 2008 to an astonishing 42 percent in 2018. The share for similar Latino/a Parent PLUS borrowers is also high, exceeding 25 percent. 

* Sixty-eight institutions show 10 percent of parents or fewer making progress after three years. Fifty-nine of them—nearly 90 percent—are HBCUs.

* Ten years after starting repayment, the parents who received Parent PLUS loans and had children attending the top colleges for Black enrollment still owe on average 96 percent of their principal, compared to 47 percent among those whose children attended the top colleges for white enrollment. 

* Many more Black parents (33 percent) and Latino/a parents (29 percent) who hold student loans for their children’s education also hold student loans for their own education, compared to just 13 percent among white parents who hold these loans.

* In the month they were surveyed, 37 percent of Black parent-borrowers said they expected to be unable to make a partial payment on their student loan bills, compared to 20 percent for all other groups. 

```{r note1, include=TRUE, echo=FALSE, warning=FALSE}
# The above stats are all calculated elsewhere in this Markdown file or in Appendix 2. 
```

Because low-income families, and especially Black and Latino/a parents, are disproportionately taking out Parent PLUS loans, their heavy use and unfavorable terms and conditions exacerbate the racial wealth gap. The situation presents particular quandaries for the HBCUs where use of these loans is greatest. 

Two major implications for policy emerge. The first is that any broad action by the Biden administration to cancel federal student debt should include the families currently trapped by debt due to Parent PLUS loans. A wave of forgiveness, such as $10,000 per borrower, would change the lives of hundreds of thousands of struggling parents. Though the full details of the plan are not yet public and potentially in flux at the time of this report’s publication, it is highly important that this forgiveness be performed on a “per borrower” basis, not a “per student” basis, in order to capture these parents.

The second implication is that the nation needs a larger reckoning on the underlying causes of dependency on this program among families and the colleges their children attend, and the lasting damage that college-related debt burdens cause families, especially families of color. Existing proposals for reform have largely focused on programmatic changes to Parent PLUS that Congress could enact, such as adjusting the rules of Parent PLUS to make fewer parents eligible and reduce how much they can borrow. While these changes would decrease the risk of repayment struggles for new borrowers, they would also put college further out of reach for the children in many low-income families. Changing the rules of the program for future borrowers is just one step needed out of several, including new federal investment in college affordability at financially strained institutions such as HBCUs.

## Introduction

The way that families pay for the expensive and still-rising cost of college is changing, with parents taking on a greater share of the financial burden, financed through loans. Across the landscape of undergraduate education, reliance on the federal Parent PLUS program has grown remarkably in the past twenty years. Consider the following: 

* Prior to enrollment declines caused by the COVID-19 pandemic, annual Parent PLUS disbursements nationwide had tripled from about $5 billion in 2000 to over $15 billion by 2016, driven mostly by a 269 percent increase in their use for attendance at public universities. (See Figure 1.)

```{r stat6, include=TRUE, echo=FALSE, warning=FALSE}
#################################################################
### Here we use the allData dataframe we created at the start ###
### of this file.                                             ###
#################################################################

tbl1Z <- aggregate(data=allData, `$ of Disbursements` ~ Year, FUN=sum)
paste("Annual disbursements in 1999-2000 totaled", dollar(tbl1Z$`$ of Disbursements`[tbl1Z$Year=="2000"])) 
```

```{r stat7, include=TRUE, echo=FALSE, warning=FALSE}
paste("Annual disbursements in 2015-16 totaled", dollar(tbl1Z$`$ of Disbursements`[tbl1Z$Year=="2016"])) 
```

```{r stat8, include=TRUE, echo=FALSE, warning=FALSE}
tbl1Y <- aggregate(data=allData, `$ of Disbursements` ~ Year + CONTROL, FUN=sum)
tbl1Y <- tbl1Y %>% filter(CONTROL %in% c(1, 2, 3))

paste("Annual disbursements at public institutions increased", percent((tbl1Y$`$ of Disbursements`[tbl1Y$CONTROL==1 & tbl1Y$Year==2017] / tbl1Y$`$ of Disbursements`[tbl1Y$CONTROL==1 & tbl1Y$Year==2000]) - 1), "between 1999-2000 and 2016-17") 
```

* At the Texas A&M System, one of the largest public university systems in the country, annual Parent PLUS loan totals rose from $56 million to $253 million between 2009 and 2019. 

```{r stat9, include=TRUE, echo=FALSE, warning=FALSE}
#################################################################
### These eight-digit OPEIDs represent the campuses of the    ###
### Texas A&M system. This list was derived from              ###
### https://www.tamus.edu/system/about/                       ###
#################################################################

TexasAM <- allData %>% filter(OPEID %in% c(
  "00363200", # Texas A&M University
  "00363000", # Prairie View A&M University
  "00356500", # Texas A&M University-Commerce
  "00363100", # Tarleton State University
  "00366500", # West Texas A&M University
  "00363900", # Texas A&M University - Kingsville
  "01116100", # Texas A&M University - Corpus Christi
  "00965100", # Texas A&M International University
  "03170300", # Texas A&M University - Texarkana
  "04229500", # Texas A&M University - Central Texas
  "04248500"  # Texas A&M University - San Antonio
))
tblAM <- aggregate(data=TexasAM, `$ of Disbursements` ~ Year, FUN=sum)
paste("In 2008-09, the Texas A&M system's annual Parent PLUS disbursements totaled", dollar(tblAM$`$ of Disbursements`[tblAM$Year==2009])) 
```

```{r stat10, include=TRUE, echo=FALSE, warning=FALSE}
paste("In 2018-19, the Texas A&M system's annual Parent PLUS disbursements totaled", dollar(tblAM$`$ of Disbursements`[tblAM$Year==2019])) 
```

* At some large for-profit colleges, Parent PLUS makes up the majority of all financial aid received by undergraduates. 

```{r stat11, include=TRUE, echo=FALSE, warning=FALSE}
#################################################################
### The IPEDS variables UAGRNTT and UFLOANT report the sum of ###
### institutions' grant aid to undergrads and the sum of      ###
### institutions non-PLUS federal student loans to undergrads.###
### By adding UAGRNTT, UFLOANT, and the `$ of Disbursements`  ###
### variable, we obtain total financial aid to undergraduates.###
### We can then find PLUS's share of total undergraduate      ###
### financial aid. We apply a $5,000,000 minimum on total aid ### 
### before identifying institutions where PLUS's share is     ###
### greatest, to filter out smaller institutions.             ###
#################################################################

allFinAid <- allData %>% filter(Year %in% c("2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019", "2020", "2021"))
allFinAid$`Total Undergraduate Grants and Loans` <- allFinAid$UAGRNTT + allFinAid$UFLOANT + allFinAid$`$ of Disbursements`
allFinAid$`PLUS share` <- allFinAid$`$ of Disbursements` / allFinAid$`Total Undergraduate Grants and Loans`

tbl5.noMin <- allFinAid %>% filter(Year=="2020") %>% select(INSTNM, CONTROL, `$ of Disbursements`, `Total Undergraduate Grants and Loans`, `PLUS share`) %>% arrange(desc(`PLUS share`)) 
tbl5.5milMin <- tbl5.noMin %>% filter(`$ of Disbursements` > 5000000) 
head(tbl5.5milMin, 10) %>% select(INSTNM, CONTROL, `$ of Disbursements`, `PLUS share`) 
```

* Use of the Parent PLUS program varies widely. While some colleges seldom see their students receive such loans, parents whose children have attended Penn State University alone are currently carrying $1.4 billion in outstanding debt. 

```{r stat12, include=TRUE, echo=FALSE, warning=FALSE}
#################################################################
### We load in from the College Scorecard institution set a   ###
### number of variables that we will use.                     ###
#################################################################

CSI <- fread("Most-Recent-Cohorts-Institution.csv", header=TRUE, select=c(
  "UNITID",           # Unit ID for institution
  "OPEID6",           # 6-digit OPE ID for institution
  "INSTNM",           # Institution name
  "MAIN",             # Flag for main campus
  "HBCU",             # Flag for Historically Black College and University
  "CONTROL",          # Control of institution
  "LPPPLUS_CNT",      # Number of students associated with outstanding Parent PLUS Loan balances
  "LPPPLUS_AMT",      # Total outstanding Parent PLUS Loan balance
  "PPLUS_PCT_LOW",    # Lower bound of estimated percentage range of students whose parents took out a PLUS loan
  "PPLUS_PCT_HIGH",   # Upper bound of estimated percentage range of students whose parents took out a PLUS loan
  "MD_EARN_WNE_P10",  # Median earnings of students working and not enrolled 10 years after entry
  "MN_EARN_WNE_P10"   # Mean earnings of students working and not enrolled 10 years after entry
)) %>% arrange(desc(MAIN)) %>% filter(duplicated(OPEID6)==FALSE) # This filtering is necessary because otherwise debt amounts may be double-counted. Arranging by main campus helps us identify institutions by their best-known name in INSTNM. 

#################################################################
### Now we ensure these are numeric columns.                  ###
#################################################################

CSI$PPLUS_PCT_LOW <- as.numeric(CSI$PPLUS_PCT_LOW)
CSI$PPLUS_PCT_HIGH <- as.numeric(CSI$PPLUS_PCT_HIGH)
CSI$MN_EARN_WNE_P10 <- as.numeric(CSI$MN_EARN_WNE_P10)
CSI$LPPPLUS_CNT <- as.numeric(CSI$LPPPLUS_CNT)
CSI$LPPPLUS_AMT <- as.numeric(CSI$LPPPLUS_AMT)

#################################################################
### Now we will copy this into a different dataframe to focus ###
### on total outstanding debt.                                ###
#################################################################

CSI2 <-  CSI %>% select(UNITID, 
                        INSTNM, 
                        HBCU,
                        CONTROL,
                        LPPPLUS_CNT,
                        LPPPLUS_AMT)
CSI2$LPPPLUS_CNT <- as.numeric(CSI2$LPPPLUS_CNT)
CSI2$LPPPLUS_AMT <- as.numeric(CSI2$LPPPLUS_AMT)
CSI2$AVGBALANCE <- CSI2$LPPPLUS_AMT / CSI2$LPPPLUS_CNT
CSI2 <- CSI2 %>% arrange(desc(LPPPLUS_AMT)) 
head(CSI2, 5) %>% select(INSTNM, LPPPLUS_AMT) 
```

* The U.S. Department of Education estimates that between 50 percent and 55 percent of undergraduates at Clark Atlanta University receive Parent PLUS loans. In other words, at Clark Atlanta University, the undergraduate population features more Parent PLUS recipients than non-recipients.

```{r stat13, include=TRUE, echo=FALSE, warning=FALSE}
#################################################################
### Now we copy another dataframe to examine the estimated    ###
### share of undergraduates who receives Parent PLUS.         ###
### We apply a minimum filter of 500 outstanding loans,       ###
### in order to filter out small schools.                     ###
#################################################################

CSI3 <- CSI %>% filter(is.na(PPLUS_PCT_LOW)==FALSE) %>% filter(is.na(PPLUS_PCT_HIGH)==FALSE) %>% filter(LPPPLUS_CNT >= 500) %>% arrange(desc(PPLUS_PCT_HIGH))
head(CSI3, 10) %>% select(INSTNM, PPLUS_PCT_LOW, PPLUS_PCT_HIGH) 
```

Figure 1. PARENT PLUS LOAN DISBURSEMENTS, BY TYPE OF SCHOOL, 2000–22

```{r figure1, include=TRUE, echo=FALSE, warning=FALSE}
###################################################################
### This chunk sums Parent PLUS disbursements by year and plots ###
### change over time by institutional control.                  ###
###################################################################

tbl1X <- aggregate(data=allData, `$ of Disbursements` ~ Year + CONTROL, FUN=sum)
tbl1X <- tbl1X %>% filter(CONTROL %in% c(1, 2, 3))
tbl1X$Control <- rep(NA, nrow(tbl1X))
tbl1X$Control[tbl1X$CONTROL==1] <- "Public"
tbl1X$Control[tbl1X$CONTROL==2] <- "Nonprofit"
tbl1X$Control[tbl1X$CONTROL==3] <- "For-profit"
tbl1X$Control <- factor(tbl1X$Control, levels=c("For-profit", "Nonprofit", "Public"))

ggplot(data=tbl1X, mapping=aes(x=Year, y=`$ of Disbursements`, color=Control)) + geom_bar(position="stack", stat="identity", fill="white") + theme(axis.text.x = element_text(angle = 45)) + scale_y_continuous(labels=scales::dollar_format()) 
```

Because the Parent PLUS program was originally intended to give high-asset families flexibility in how they pay for their childrens’ college, Congress created it with higher interest rates and origination fees that would fully cover the federal program’s administration costs. These details, however, also make Parent PLUS loans more expensive for borrowers, particularly over the long run, and thus a less than ideal choice for low-income, low-wealth families. Parent PLUS loans are also ineligible for most income-driven repayment plans offered by the federal government, and they are as difficult as any other student loan to discharge in bankruptcy. And yet, they are remarkably easy to obtain, with applications for tens of thousands of dollars completed and processed in mere minutes. The amount a family can take out in Parent PLUS is capped by nothing but the balance of their child’s full tuition and other expenses after applying other aid.

The features of the Parent PLUS program described above can create a perfect storm of financial troubles for families without high income or access to wealth, and so through Parent PLUS, a family can find themselves loaded with enormous debt. When issuing these loans, the government assumes that the family understands the long-term consequences of signing the loan agreement. As with all student loans, while some Parent PLUS borrowers can repay without hardship, others struggle, entering delinquency or default. But unlike other federal student loans, the burden of repayment for a Parent PLUS loan falls on the parent, not the child. Many parents are likely to enter repayment with few opportunities to improve their earnings, while some will even be on the cusp of retirement. 

Ability to repay Parent PLUS is a matter of income and wealth. Parent PLUS poses a dilemma for Black and Latino families in particular, who may view higher education as one of the only available opportunities to ensure their child achieves upward mobility. As much as Parent PLUS opens doors for their children, it can close doors for the parents: as a result of these loans, they could find themselves unable to retire at the age they otherwise would, having to pull from savings sooner than they planned, or even living below the poverty line if their Social Security payments must be offset due to loan default. 

Seeking to help their children find upward mobility through higher education, low-income and low-wealth parents taking out these loans risk making themselves downwardly mobile, a consequence no family should suffer in the name of college opportunity. The following sections use the latest data to examine in detail how the most vulnerable families rely on Parent PLUS and face compounding financial challenges during repayment. 

In this report, we primarily focus on disparities between Black or Latino/a parents and white parents. Statistics on other groups are limited by sample size constraints, but they are presented in this report where samples are sufficient. 

## What PLUS Equals for Black and Latino Families 

Congress established the Parent PLUS program in 1980 with the intention of making it easier for parents who had the ability to pay tuition—that is, the financial aid formulae showed them as having positive expected family contributions (EFCs)—but faced current liquidity constraints and preferred not to make their children seek additional loans. Documents from a congressional hearing in 1980 indicate a prevailing assumption that the program would serve middle-class families: proponents argued that it recognized  “the reality that middle-income families are feeling hard-pressed to pay colleges’ bills out of current income” and “growing evidence that many middle-income families are finding it difficult in the short term to provide the funds expected from them in the form of the parental contribution.” 

In the four decades since, college enrollment by students from low-income families has increased, and the price of college has risen significantly. In response, families at all income levels have shown increased reliance on the Parent PLUS program to pay for college. (See Table 1.) Unfortunately, this means the program is now used by many families who do not fit the intended middle-class parent mold. 

For example, the percentage of students from families living under the federal poverty line who receive Parent PLUS loans has risen from 1 percent to 3 percent since the mid-1990s, with a similar rise for those whose families live between 100 percent and 200 percent of the federal poverty line. While 3 percent may seem low, it represents a hundred thousand families every year who are barely scraping by, for whom even a small loan is a risky venture. 

When we combine this with the fact that low-income families are enrolling in college at a higher rate, we find that there were roughly 3.5 times as many Parent PLUS recipients from under the poverty line in 2018 compared to 1996. 

Table 1. ESTIMATED PARENT PLUS LOAN RECIPIENTS, BY INCOME, 1996 VERSUS 2018

```{r table1, include=TRUE, echo=FALSE, warning=FALSE}
#######################################################
### This chunk uses data from NPSAS to estimate the ###
### share of students who receive PLUS by federal   ###
### poverty level (FPL). It also uses enrollment    ###
### totals from the National Center on Education    ###
### Statistics' Digest of Education Statistics for  ###
### total undergraduate headcount enrollment.       ###
### We compare statistics reflecting the 1995-96    ###
### year with statistics reflecting 2017-18.        ###
### For the total undergraduate enrollment figures  ###
### from NCES, we use total fall enrollment as a    ###
### proxy for year-round enrollment.                ###
#######################################################

#######################################################
### These Powerstats files are derived from queries ###
### run in NCES Datalab, accessible at              ###
### https://nces.ed.gov/datalab/                    ###
### The six-character code in the CSV file name     ###
### corresponds to the table retrieval number.      ###
#######################################################

# (1) Estimated total undergraduates who receive Parent PLUS, by FPL 
fpl.PLUS.totals96 <- read.csv("Powerstats bnzvzf.csv", header=FALSE, skip=40, nrow=5) %>% select(V1, V3)
fpl.PLUS.totals18 <- read.csv("Powerstats kktnnb.csv", header=FALSE, skip=40, nrow=5) %>% select(V1, V3)

# (2) Estimated share of undergraduates by FPL
fpl.UG.percents96 <- read.csv("PowerStats vdhtbw.csv", header=FALSE, skip=11, nrow=1) %>% select(V1, V2, V3, V4, V5, V6)
fpl.UG.percents18 <- read.csv("PowerStats fcuzvd.csv", header=FALSE, skip=11, nrow=1) %>% select(V1, V2, V3, V4, V5, V6)

# (3) Total undergraduate enrollment from NCES  (Digest of Education Statistics Table #303.70)
total.UG.headcount96 <- 12231719	# Fall 1995
total.UG.headcount18 <- 16773036  # Fall 2017

# (4) Estimated total undergraduates by poverty level 
fpl.UG.totals96 <- as.numeric((fpl.UG.percents96[1, 2:6] / 100)) * as.numeric(total.UG.headcount96)
fpl.UG.totals18 <- as.numeric((fpl.UG.percents18[1, 2:6] / 100)) * as.numeric(total.UG.headcount18)

povTable <- data.frame("Group"=c("Up to 100% FPL", "101%-200% FPL", "201%-300% FPL", "301%-400% FPL", "Greater than 400% FPL"), 
                       "Share of all undergraduates, 1996" = (as.numeric(fpl.UG.percents96[1, 2:6]) / 100), 
                       "Percentage who received Parent PLUS, 1996" = (as.numeric(fpl.PLUS.totals96[, 2]) / as.numeric(fpl.UG.totals96)), 
                       "Estimated Parent PLUS recipients, 1996" = as.numeric(fpl.PLUS.totals96[, 2]), 
                       "Share of all undergraduates, 2018" = (as.numeric(fpl.UG.percents18[1, 2:6]) / 100), 
                       "Percentage who received Parent PLUS, 2018" = (as.numeric(fpl.PLUS.totals18[, 2]) / as.numeric(fpl.UG.totals18)), 
                       "Estimated Parent PLUS recipients, 2018" = as.numeric(fpl.PLUS.totals18[, 2]))

povTable <- povTable %>% add_row(Group="All students", 
                                 Share.of.all.undergraduates..1996 = 1, # Done
                                 Percentage.who.received.Parent.PLUS..1996 = sum(as.numeric(fpl.PLUS.totals96[, 2]) / sum(as.numeric(fpl.UG.totals96))), 
                                 Estimated.Parent.PLUS.recipients..1996 = sum(povTable$Estimated.Parent.PLUS.recipients..1996), 
                                 Share.of.all.undergraduates..2018 = 1, # Done
                                 Percentage.who.received.Parent.PLUS..2018 = sum(as.numeric(fpl.PLUS.totals18[, 2]) / sum(as.numeric(fpl.UG.totals18))), 
                                 Estimated.Parent.PLUS.recipients..2018 = sum(povTable$Estimated.Parent.PLUS.recipients..2018))

povTable$Share.of.all.undergraduates..1996 <- percent(povTable$Share.of.all.undergraduates..1996, accuracy=0.1)
povTable$Percentage.who.received.Parent.PLUS..1996 <- percent(povTable$Percentage.who.received.Parent.PLUS..1996, accuracy=0.1)
povTable$Estimated.Parent.PLUS.recipients..1996 <- round(povTable$Estimated.Parent.PLUS.recipients..1996, digits=-3)
povTable$Share.of.all.undergraduates..2018 <- percent(povTable$Share.of.all.undergraduates..2018, accuracy=0.1)
povTable$Percentage.who.received.Parent.PLUS..2018 <- percent(povTable$Percentage.who.received.Parent.PLUS..2018, accuracy=0.1)
povTable$Estimated.Parent.PLUS.recipients..2018 <- round(povTable$Estimated.Parent.PLUS.recipients..2018, digits=-3)

names(povTable) <- c("Group", 
                     "Share of all undergraduates, 1996", 
                     "Percentage who received Parent PLUS, 1996", 
                     "Estimated Parent PLUS recipients, 1996", 
                     "Share of all undergraduates, 2018", 
                     "Percentage who received Parent PLUS, 2018", 
                     "Estimated Parent PLUS recipients, 2018")
povTable
```

Today, most Parent PLUS recipients also receive Pell, placing them among the most low-income and low-asset families enrolled. At public institutions, 50 percent of Parent PLUS recipients receive Pell; at nonprofit colleges, 52 percent receive Pell; and at for-profit colleges, 71 percent receive Pell. Meanwhile, at HBCUs, 80 percent of Parent PLUS recipients receive Pell. These high rates of program use are just one indication of how the soaring cost of college has led many low-income, low-wealth families to essentially sign away their financial futures by taking on Parent PLUS loans.

```{r stat14, include=TRUE, echo=FALSE, warning=FALSE}
#######################################################
### We are interested here in the share of Parent   ###
### PLUS recipients who receive Pell. We load in    ###
### institution-level data from the College         ###
### Scorecard and format the columns as numbers.    ###
#######################################################

CSI11 <- fread("Most-Recent-Cohorts-Institution.csv", header=TRUE, select=c(
  "UNITID",                  # Unit ID for institution
  "INSTNM",                  # Institution name
  "OPEID6",                  # 6-digit OPE ID for institution
  "HBCU",                    # Flag for Historically Black College and University
  "CONTROL",                 # Control of institution
  "PLUS_DEBT_INST_MD",       # Median PLUS loan debt disbursed at this institution
  "PPLUS_PCT_LOW",           # Lower bound of estimated percentage range of students whose parents took out a PLUS loan
  "PPLUS_PCT_HIGH",          # Upper bound of estimated percentage range of students whose parents took out a PLUS loan
  "PLUS_DEBT_INST_N",        # Student recipient count for median PLUS loan debt disbursed at this institution
  "PLUS_DEBT_INST_PELL_N"    # Student recipient count for median PLUS loan debt disbursed to Pell recipients at this institution
)) %>% filter(duplicated(OPEID6)==FALSE) # This filtering is necessary because otherwise debt amounts may be double-counted. 

CSI11$PPLUS_PCT_LOW <- as.numeric(CSI11$PPLUS_PCT_LOW)
CSI11$PPLUS_PCT_HIGH <- as.numeric(CSI11$PPLUS_PCT_HIGH)
CSI11$PLUS_DEBT_INST_N <- as.numeric(CSI11$PLUS_DEBT_INST_N)
CSI11$PLUS_DEBT_INST_PELL_N <- as.numeric(CSI11$PLUS_DEBT_INST_PELL_N)
CSI11$PLUS_DEBT_INST_MD <- as.numeric(CSI11$PLUS_DEBT_INST_MD)

#######################################################
### Now we filter out institutions where there is   ###
### no data on the number of PLUS recipients or the ###
### number of PLUS recipients who receive Pell.     ###
### We then find the share of PLUS recipients who   ###
### receive Pell by institutional control.          ###
#######################################################

CSI11 <- CSI11 %>% filter(is.na(PLUS_DEBT_INST_N)==FALSE
                          &
                          is.na(PLUS_DEBT_INST_PELL_N)==FALSE)

tbl24 <- aggregate(data=CSI11, cbind(PLUS_DEBT_INST_PELL_N, PLUS_DEBT_INST_N) ~ CONTROL, FUN=sum)

tbl24$`Share of PLUS borrowers who receive Pell` <- tbl24$PLUS_DEBT_INST_PELL_N / tbl24$PLUS_DEBT_INST_N
tbl24
```

```{r stat15, include=TRUE, echo=FALSE, warning=FALSE}
#######################################################
### We now do the same, but for HBCU status.        ###
#######################################################

tbl25 <- aggregate(data=CSI11, cbind(PLUS_DEBT_INST_PELL_N, PLUS_DEBT_INST_N) ~ HBCU, FUN=sum)

tbl25$`Share of PLUS borrowers who receive Pell` <- tbl25$PLUS_DEBT_INST_PELL_N / tbl25$PLUS_DEBT_INST_N
tbl25
```

Parent PLUS amounts are high, with the average annual disbursement topping $18,000 as of the 2019–20 award year, up from $12,000 in inflation-adjusted dollars in 1999–2000. And Parent PLUS is not the only student loan debt a family may have. Because Parent PLUS loans have a higher interest rate than Stafford loans, many families turn to Parent PLUS only after tapping other federal student loan options. Consider that students who earned a bachelor’s degree in 2015–16 and received Parent PLUS averaged approximately $29,000 in Stafford loan debt, $33,000 in Parent PLUS debt, and $4,000 in private loan debt, totaling $66,000 in loan debt for the whole family—roughly $80,000, after adjusting for inflation. 

```{r stat16A, include=TRUE, echo=FALSE, warning=FALSE}
#######################################################
### We use the allData dataframe to sum             ###
### disbursements and recipients by year, and then  ###
### derive an average for 1999-00 and 2019-20.      ###
#######################################################

tbl3F <- aggregate(data=allData, cbind(`$ of Disbursements`, Recipients) ~ Year, FUN=sum)
tbl3F$`Average disbursement` <- tbl3F$`$ of Disbursements` / tbl3F$Recipients 
paste("The average Parent PLUS disbursement in 2019-20 was", dollar(tbl3F$`Average disbursement`[tbl3F$Year=="2020"])) 
```

```{r stat16B, include=TRUE, echo=FALSE, warning=FALSE}
paste("The average Parent PLUS disbursement in 1999-2000 was", dollar(tbl3F$`Average disbursement`[tbl3F$Year=="2000"])) 
```

```{r stat17, include=TRUE, echo=FALSE, warning=FALSE}
#######################################################
### The following stats on average loan amounts for ###
### PLUS recipients was derived from the            ###
### Baccalaureate & Beyond Study (2008/18),         ### 
### retrievable via NCES Datalab table retrieval    ###
### number rlpvam.                                  ###
#######################################################

rlpvam <- read.csv("Powerstats rlpvam.csv", header=FALSE, skip=9, nrow=1) %>% select(V2, V3, V4)
rlpvam2 <- data.frame("Measure" = c("Cumulative federal loan amount for undergrad", 
                                    "Cumulative non-federal loan amount for undergrad", 
                                    "Cumulative Parent PLUS Loans"), 
                       "Average among 2007-08 graduating PLUS reicpients" = c(rlpvam$V2[1], 
                                                                              rlpvam$V3[1], 
                                                                              rlpvam$V4[1]))
names(rlpvam2) <- c("Measure", "Average among 2007-08 graduating PLUS reicpients")
rlpvam2 <- rlpvam2 %>% add_row(Measure="Total", `Average among 2007-08 graduating PLUS reicpients` = (rlpvam$V2[1] + rlpvam$V3[1] + rlpvam$V4[1]))
rlpvam2
```

This forms what New America’s Rachel Fishman coined as the “intergenerational loan debt” that Parent PLUS families carry. And these totals don’t include the home equity loans and high-interest credit card debt that a family may have taken on for their child’s education: these are not tracked by Department of Education sources, but estimates using Federal Reserve data indicate that about 12 percent of parent-borrowers use a home equity loan for their child’s education and 18 percent use credit card debt. 

```{r stat18, include=TRUE, echo=FALSE, warning=FALSE}
# See Appendix 2 of the report and the accompanying R Markdown file and code.  
```

Though the establishment of Parent PLUS was race-neutral on its face, the changing nature of Parent PLUS has racial contours. Between the 1995–96 award year and the 2017–18 award year, the share of Black students whose parents took out Parent PLUS loans rose from 3.5 percent to 6.2 percent, a larger increase than that for white students (3.6 percent to 5.1 percent). Meanwhile, the rates for Latino/a students saw a considerable rise relative to a low starting point, from 2.0 percent to 3.1 percent. (See Table 2.) 

Considering growth in enrollment has occurred over this period as well, we find the annual number of Black Parent PLUS borrowers nearly tripled between 1996 and 2018. Meanwhile, Latino/a Parent PLUS borrowers nearly quadrupled over this period, though from a lower starting point, and this is driven in large part by greater enrollment by Latino/a students. 

Table 2. ESTIMATED PARENT PLUS RECIPIENTS, BY RACE/ETHNICITY, 1996 VERSUS 2018

```{r table2, include=TRUE, echo=FALSE, warning=FALSE}
#######################################################
### This chunk uses data from NPSAS to estimate the ###
### share of students who receive PLUS by race.     ###
### It also uses enrollment totals from the         ###
### National Center on Education Statistics'        ###
### Digest of Education Statistics for              ###
### total undergraduate headcount enrollment.       ###
### We compare statistics reflecting the 1995-96    ###
### year with statistics reflecting 2017-18.        ###
### For the total undergraduate enrollment figures  ###
### from NCES, we use total fall enrollment as a    ###
### proxy for year-round enrollment.                ###
#######################################################

#######################################################
### These Powerstats files are derived from queries ###
### run in NCES Datalab, accessible at              ###
### https://nces.ed.gov/datalab/                    ###
### The six-character code in the CSV file name     ###
### corresponds to the table retrieval number.      ###
#######################################################

# (1) Estimated total undergraduates who receive Parent PLUS, by race
rac.PLUS.totals96 <- read.csv("Powerstats hwjvcr.csv", header=FALSE, skip=43, nrow=6) %>% select(V1, V3)
rac.PLUS.totals18 <- read.csv("Powerstats lubjnx.csv", header=FALSE, skip=43, nrow=6) %>% select(V1, V3)

# (2) Estimated share of undergraduates by race
rac.UG.percents96 <- read.csv("PowerStats vzicpu.csv", header=FALSE, skip=11, nrow=1) %>% select(V1, V2, V3, V4, V5, V6, V7)
rac.UG.percents18 <- read.csv("PowerStats locuyc.csv", header=FALSE, skip=11, nrow=1) %>% select(V1, V2, V3, V4, V5, V6, V7)

# (3) Total undergraduate enrollment from NCES  (Digest of Education Statistics Table #303.70)
total.UG.headcount96 <- 12231719	
total.UG.headcount18 <- 16773036

# (4) Estimated total undergraduates by race 
rac.UG.totals96 <- as.numeric((rac.UG.percents96[1, 2:7] / 100)) * as.numeric(total.UG.headcount96)
rac.UG.totals18 <- as.numeric((rac.UG.percents18[1, 2:7] / 100)) * as.numeric(total.UG.headcount18)

racTable <- data.frame("Group"=c("White", "Black", "Latino/a", "Asian/Pacific Islander", "Native American", "Other race"), 
                       "Share of all undergraduates, 1996" = (as.numeric(rac.UG.percents96[1, 2:7]) / 100), 
                       "Percentage who received Parent PLUS, 1996" = (as.numeric(rac.PLUS.totals96[, 2]) / as.numeric(rac.UG.totals96)), 
                       "Estimated Parent PLUS recipients, 1996" = as.numeric(rac.PLUS.totals96[, 2]), 
                       "Share of all undergraduates, 2018" = (as.numeric(rac.UG.percents18[1, 2:7]) / 100), 
                       "Percentage who received Parent PLUS, 2018" = (as.numeric(rac.PLUS.totals18[, 2]) / as.numeric(rac.UG.totals18)), 
                       "Estimated Parent PLUS recipients, 2018" = as.numeric(rac.PLUS.totals18[, 2]))

racTable <- racTable %>% add_row(Group="All students", 
                                 Share.of.all.undergraduates..1996 = 1, # Done
                                 Percentage.who.received.Parent.PLUS..1996 = sum(as.numeric(rac.PLUS.totals96[, 2]) / sum(as.numeric(rac.UG.totals96))), 
                                 Estimated.Parent.PLUS.recipients..1996 = sum(racTable$Estimated.Parent.PLUS.recipients..1996), 
                                 Share.of.all.undergraduates..2018 = 1, # Done
                                 Percentage.who.received.Parent.PLUS..2018 = sum(as.numeric(rac.PLUS.totals18[, 2]) / sum(as.numeric(rac.UG.totals18))), 
                                 Estimated.Parent.PLUS.recipients..2018 = sum(racTable$Estimated.Parent.PLUS.recipients..2018))

racTable$Share.of.all.undergraduates..1996 <- percent(racTable$Share.of.all.undergraduates..1996, accuracy=0.1)
racTable$Percentage.who.received.Parent.PLUS..1996 <- percent(racTable$Percentage.who.received.Parent.PLUS..1996, accuracy=0.1)
racTable$Estimated.Parent.PLUS.recipients..1996 <- round(racTable$Estimated.Parent.PLUS.recipients..1996, digits=-3)
racTable$Share.of.all.undergraduates..2018 <- percent(racTable$Share.of.all.undergraduates..2018, accuracy=0.1)
racTable$Percentage.who.received.Parent.PLUS..2018 <- percent(racTable$Percentage.who.received.Parent.PLUS..2018, accuracy=0.1)
racTable$Estimated.Parent.PLUS.recipients..2018 <- round(racTable$Estimated.Parent.PLUS.recipients..2018, digits=-3)

names(racTable) <- c("Group", 
                     "Share of all undergraduates, 1996", 
                     "Percentage who received Parent PLUS, 1996", 
                     "Estimated Parent PLUS recipients, 1996", 
                     "Share of all undergraduates, 2018", 
                     "Percentage who received Parent PLUS, 2018", 
                     "Estimated Parent PLUS recipients, 2018")
racTable
```

With the marked overall increase in program use by Black and Latino/a families, on top of high rates of use by low-income, low-wealth families, there is little surprise, then, that Parent PLUS borrowing has grown the most at colleges that serve more low-income and Black and Latino/a students. And at these institutions, Parent PLUS is taking up a greater share of the financial aid students receive. Of particular note, HBCUs have for the better part of a decade surpassed other institution types for the share of undergraduate financial aid comprised by Parent PLUS, and by a sizable margin. (See Figure 2.) 

Figure 2. PARENT PLUS SHARE OF UNDERGRADUATE LOANS AND GRANTS, BY TYPE OF INSTITUTION, 2009–21

```{r figure2, include=TRUE, echo=FALSE, warning=FALSE}
#######################################################
### Here we join MSI indicator data from College    ###
### Scorecard with our allFinAid dataframe in order ###
### to compare Parent PLUS's share of total aid     ###
### by MSI status(es).                              ###
#######################################################

allFinAid3 <- allFinAid
MSI <- fread("Most-Recent-Cohorts-Institution.csv", header=TRUE, select=c(
  "UNITID",  # Unit ID for institution
  "PBI",     # Flag for predominantly black institution
  "ANNHI",   # Flag for Alaska Native Native Hawaiian serving institution
  "TRIBAL",  # Flag for tribal college and university
  "AANAPII", # Flag for Asian American Native American Pacific Islander-serving institution
  "HSI",     # Flag for Hispanic-serving institution
  "NANTI"    # Flag for Native American non-tribal institution
  # HBCU status is already in the allFinAid dataset. 
))
allFinAid3 <- left_join(x=allFinAid3, y=MSI, by="UNITID")
allFinAid3$`Parent PLUS's Share of Undergraduate Loans and Grants` <- allFinAid3$`$ of Disbursements` / allFinAid3$`Total Undergraduate Grants and Loans`

########################################################
### We now create one new dataframe per individual   ###
### MSI (it is not a problem if the same institution ###
### appears in multiple dataframes).                 ###
########################################################

allFinAid.HBCU <- allFinAid3 %>% filter(HBCU==1)
allFinAid.PBI <- allFinAid3 %>% filter(PBI==1)
allFinAid.ANNHI <- allFinAid3 %>% filter(ANNHI==1)
allFinAid.TRIBAL <- allFinAid3 %>% filter(TRIBAL==1)
allFinAid.AANAPII <- allFinAid3 %>% filter(AANAPII==1)
allFinAid.HSI <- allFinAid3 %>% filter(HSI==1)
allFinAid.NANTI <- allFinAid3 %>% filter(NANTI==1)
allFinAid.nonMSI <- allFinAid3 %>% filter((HBCU != 1) & (PBI  != 1) & (ANNHI  != 1) & (TRIBAL  != 1) & (AANAPII  != 1) & (HSI  != 1) & (NANTI  != 1))

#######################################################
### Now we label them before re-combining the       ###
### dataframes.                                     ###
#######################################################

allFinAid.HBCU$`MSI Category` <- rep("HBCU", nrow(allFinAid.HBCU))
allFinAid.PBI$`MSI Category` <- rep("PBI", nrow(allFinAid.PBI))
allFinAid.ANNHI$`MSI Category` <- rep("ANNHI", nrow(allFinAid.ANNHI))
allFinAid.TRIBAL$`MSI Category` <- rep("TCU", nrow(allFinAid.TRIBAL))
allFinAid.AANAPII$`MSI Category` <- rep("AANAPII", nrow(allFinAid.AANAPII))
allFinAid.HSI$`MSI Category` <- rep("HSI", nrow(allFinAid.HSI))
allFinAid.NANTI$`MSI Category` <- rep("NANTI", nrow(allFinAid.NANTI))
allFinAid.nonMSI$`MSI Category` <- rep("Not an MSI", nrow(allFinAid.nonMSI))

allFinAid.HBCU <- allFinAid.HBCU %>% select(UNITID, Year, `MSI Category`, `$ of Disbursements`, `Total Undergraduate Grants and Loans`)
allFinAid.PBI <- allFinAid.PBI %>% select(UNITID, Year, `MSI Category`, `$ of Disbursements`, `Total Undergraduate Grants and Loans`)
allFinAid.ANNHI <- allFinAid.ANNHI %>% select(UNITID, Year, `MSI Category`, `$ of Disbursements`, `Total Undergraduate Grants and Loans`)
allFinAid.TRIBAL <- allFinAid.TRIBAL %>% select(UNITID, Year, `MSI Category`, `$ of Disbursements`, `Total Undergraduate Grants and Loans`)
allFinAid.AANAPII <- allFinAid.AANAPII %>% select(UNITID, Year, `MSI Category`, `$ of Disbursements`, `Total Undergraduate Grants and Loans`)
allFinAid.HSI <- allFinAid.HSI %>% select(UNITID, Year, `MSI Category`, `$ of Disbursements`, `Total Undergraduate Grants and Loans`)
allFinAid.NANTI <- allFinAid.NANTI %>% select(UNITID, Year, `MSI Category`, `$ of Disbursements`, `Total Undergraduate Grants and Loans`)
allFinAid.nonMSI <- allFinAid.nonMSI %>% select(UNITID, Year, `MSI Category`, `$ of Disbursements`, `Total Undergraduate Grants and Loans`)

allFinAid.MSI <- rbind(allFinAid.HBCU, allFinAid.PBI, allFinAid.ANNHI, allFinAid.TRIBAL, allFinAid.AANAPII, allFinAid.HSI, allFinAid.NANTI, allFinAid.nonMSI)

#########################################################
### We can now aggregate and plot the sums over time. ###
#########################################################

tblMSI <- aggregate(data=allFinAid.MSI, cbind(`$ of Disbursements`, `Total Undergraduate Grants and Loans`) ~ `MSI Category` + Year, FUN=sum)
tblMSI$`Parent PLUS's Share of Undergraduate Loans and Grants` <- tblMSI$`$ of Disbursements` / tblMSI$`Total Undergraduate Grants and Loans`

ggplot(data=tblMSI, mapping=aes(x=Year, y=`Parent PLUS's Share of Undergraduate Loans and Grants`, group=`MSI Category`)) + geom_line(aes(color=`MSI Category`)) + geom_point() + labs(y="Parent PLUS's Share of Undergraduate Loans and Grants") + theme(axis.text.x = element_text(angle = 45)) + scale_y_continuous(labels = scales::percent_format(accuracy = 1)) 
```

It would take more than just this report to explain why parents of HBCU students feel compelled to access funds through the Parent PLUS program to pay for the cost of college. My colleague Denise Smith has explained the financial challenges due to historic underfunding of these institutions, as well as the affordability challenges faced by families whose children attend them. With all this in mind, then, it is not surprising that HBCUs comprise many of the institutions where reliance on Parent PLUS is greatest. To showcase how dire the situation is for HBCU attendees, for example, out of all the nation’s institutions of higher education, there are only six that enroll at least 2,000 undergraduate students per year, see 25 percent of their undergraduates’ families borrow via Parent PLUS, and have a median total Parent PLUS loan principal of $40,000 or more when the student leaves the college. Five of these six institutions are HBCUs. In other words, many families at these institutions have to borrow greatly for their children to attend college, even if they attend institutions that were explicitly set up for them. This comports with prior research, which found that more than one in five HBCU students and their families used Parent PLUS to pay for 30 percent or more of their college costs.

```{r stat19, include=TRUE, echo=FALSE, warning=FALSE}
#######################################################
### This code looks for institutions where at least ###
### 25% of undergraduates receive PLUS, the median  ###
### is at least $40,000, and where at least 2,000   ###
### undergraduates were enrolled in 2019-20.        ###
#######################################################

tblQF <- CSI11 %>% filter(PPLUS_PCT_LOW >= 25
                          &
                          PLUS_DEBT_INST_MD >= 40000)

effy2020.1 <- fread("effy2020.csv", header=TRUE, select=c(
  "UNITID", 
  "EFFYALEV", 
  "EFYTOTLT"
)) %>% filter(EFFYALEV==2)

tblQF <- left_join(x=tblQF, y=effy2020.1, by="UNITID") %>% filter(EFYTOTLT > 2000) 
tblQF %>% select(INSTNM, HBCU, CONTROL, PPLUS_PCT_LOW, PPLUS_PCT_HIGH, PLUS_DEBT_INST_MD, EFYTOTLT) 
```

The racial wealth gap is both a source of these disparities in Parent PLUS usage and a barrier to repayment. Researchers at Brookings estimated that, in 2016, the typical Black family’s net worth was $17,150, compared to $171,000 for the typical white family—a tenfold disparity. Of students who graduated with their bachelor’s degree that same year, the percentage of Black students who received Parent PLUS loans resulting in a debt load in excess of the typical Black family’s net worth was 44 percent. By contrast, the percentage of white students who received Parent PLUS loans in excess of the typical white family’s net worth was just 0.4 percent. 

```{r stat20, include=TRUE, echo=FALSE, warning=FALSE}
#######################################################
### These stats are derived from the Baccalaureate  ###
### & Beyond Study (2016/17), table retrieval       ###
### numbers gpvgli and icjulk.                      ###
#######################################################

gpvgli <- read.csv("Powerstats gpvgli.csv", header=FALSE, skip=13, nrow=4) 
icjulk <- read.csv("Powerstats icjulk.csv", header=FALSE, skip=13, nrow=4) 

paste("The percentage of Black graduates whose families took out more in Parent PLUS loans") 
paste("than the typical U.S. Black family's net worth is", gpvgli$V3[gpvgli$V1=="Black or African American"])
paste("The percentage of white graduates whose families took out more in Parent PLUS loans")
paste("than the typical U.S. white family's net worth is", substr(icjulk$V3[icjulk$V1=="White"], 1, 5))
```

Moreover, as Rachel Fishman has found, Black families and white families do not borrow through Parent PLUS in the same ways. For the families of white students, as income increases, so does Parent PLUS take-up: more of those who can repay take on Parent PLUS. For the families of Black students, the opposite is true; as income decreases, Parent PLUS take-up increases. These same patterns also hold when considering total college-related intergenerational debt, when loans held by the dependent student are included. 

This means that, in comparison to other groups, Black Parent PLUS borrowers are likely to be poorer. In 2012, 33 percent of the Black families who took on a Parent PLUS loan had no expected family contribution (EFC), meaning they were too poor to be able to pay anything out of pocket for college. These are families whose finances are in the most dire of straits. It is no coincidence, then, that when the Department of Education required Parent PLUS borrowers to pass an adverse credit history check starting in fall 2012, HBCUs’ annual Parent PLUS disbursements fell 36 percent within one year. (This credit history check has since been scaled back, allowing for exceptions based on extenuating circumstances and the support of an endorser.) 

These patterns, in which an outsized share of Black Parent PLUS borrowers are also poor, are growing more extreme. By 2016, 40 percent of Black Parent PLUS recipients were zero-EFC, and as of 2018, the figure had risen to 42 percent. Meanwhile, in 2018, 26 percent of Latino Parent PLUS recipients were zero-EFC, whereas the share was 8 percent for white students. (See Figure 3.) All this bodes poorly for these families’ repayment prospects.

Figure 3. SHARE OF PARENT PLUS RECIPIENTS WHO ARE ZERO-EFC, BY RACE, 2000–18

```{r figure3, include=TRUE, echo=FALSE, warning=FALSE}
#######################################################
### In this chunk we plot the share of PLUS         ###
### recipients who are $0-EFC by race over various  ###
### iterations of the NPSAS study from 2000 to 2018.###
#######################################################

#######################################################
### These Powerstats files are derived from queries ###
### run in NCES Datalab, accessible at              ###
### https://nces.ed.gov/datalab/                    ###
### The six-character code in the CSV file name     ###
### corresponds to the table retrieval number.      ###
#######################################################

efc18 <- read.csv("PowerStats jkaafa.csv", header=FALSE, skip=13, nrow=4) %>% select(V1, V2)
efc16 <- read.csv("PowerStats uewtwv.csv", header=FALSE, skip=13, nrow=4) %>% select(V1, V2)
efc12 <- read.csv("PowerStats vipbvd.csv", header=FALSE, skip=13, nrow=4) %>% select(V1, V2)
efc08 <- read.csv("PowerStats rjyqgr.csv", header=FALSE, skip=13, nrow=4) %>% select(V1, V2)
efc04 <- read.csv("PowerStats papzzq.csv", header=FALSE, skip=13, nrow=4) %>% select(V1, V2)
efc00 <- read.csv("PowerStats ppercq.csv", header=FALSE, skip=13, nrow=4) %>% select(V1, V2)
efc96 <- read.csv("PowerStats ahnplm.csv", header=FALSE, skip=13, nrow=4) %>% select(V1, V2)

efcChart <- data.frame("Year"=c("2000"), "Group"=c("White"), "Share"=c(efc00$V2[1]))
efcChart <- efcChart %>% add_row(Year="2000", Group="Black", Share=efc00$V2[2])
efcChart <- efcChart %>% add_row(Year="2000", Group="Latino/a", Share=efc00$V2[3])
efcChart <- efcChart %>% add_row(Year="2000", Group="Asian", Share=efc00$V2[4])
efcChart <- efcChart %>% add_row(Year="2000", Group="All students", Share=4.9844)
                                   
efcChart <- efcChart %>% add_row(Year="2004", Group="White", Share=efc04$V2[1])
efcChart <- efcChart %>% add_row(Year="2004", Group="Black", Share=efc04$V2[2])
efcChart <- efcChart %>% add_row(Year="2004", Group="Latino/a", Share=efc04$V2[3])
efcChart <- efcChart %>% add_row(Year="2004", Group="Asian", Share=efc04$V2[4])
efcChart <- efcChart %>% add_row(Year="2004", Group="All students", Share=6.08)

efcChart <- efcChart %>% add_row(Year="2008", Group="White", Share=efc08$V2[1])
efcChart <- efcChart %>% add_row(Year="2008", Group="Black", Share=efc08$V2[2])
efcChart <- efcChart %>% add_row(Year="2008", Group="Latino/a", Share=efc08$V2[3])
efcChart <- efcChart %>% add_row(Year="2008", Group="Asian", Share=efc08$V2[4])
efcChart <- efcChart %>% add_row(Year="2008", Group="All students", Share=7.3878)
                                   
efcChart <- efcChart %>% add_row(Year="2012", Group="White", Share=efc12$V2[1])
efcChart <- efcChart %>% add_row(Year="2012", Group="Black", Share=efc12$V2[2])
efcChart <- efcChart %>% add_row(Year="2012", Group="Latino/a", Share=efc12$V2[3])
efcChart <- efcChart %>% add_row(Year="2012", Group="Asian", Share=efc12$V2[4])
efcChart <- efcChart %>% add_row(Year="2012", Group="All students", Share=15.7945)

efcChart <- efcChart %>% add_row(Year="2016", Group="White", Share=efc16$V2[1])
efcChart <- efcChart %>% add_row(Year="2016", Group="Black", Share=efc16$V2[2])
efcChart <- efcChart %>% add_row(Year="2016", Group="Latino/a", Share=efc16$V2[3])
efcChart <- efcChart %>% add_row(Year="2016", Group="Asian", Share=efc16$V2[4])
efcChart <- efcChart %>% add_row(Year="2016", Group="All students", Share=18.0133)

efcChart <- efcChart %>% add_row(Year="2018", Group="White", Share=efc18$V2[1])
efcChart <- efcChart %>% add_row(Year="2018", Group="Black", Share=efc18$V2[2])
efcChart <- efcChart %>% add_row(Year="2018", Group="Latino/a", Share=efc18$V2[3])
efcChart <- efcChart %>% add_row(Year="2018", Group="Asian", Share=efc18$V2[4])
efcChart <- efcChart %>% add_row(Year="2018", Group="All students", Share=17.5019)

efcChart$Year <- as.numeric(efcChart$Year)
efcChart$Group <- as.factor(efcChart$Group)
efcChart$Share <- efcChart$Share / 100

ggplot(data=efcChart, mapping=aes(x=Year, y=Share, group=Group)) + geom_line(aes(color=Group)) + geom_point() + labs(x="Year", y="Share of Parent PLUS recipients who are zero-EFC") + scale_y_continuous(lim=c(0, 0.45), labels = scales::percent_format(accuracy = 1)) + scale_x_continuous(breaks=c(2000, 2004, 2008, 2012, 2016)) 
```

### Can Students Help Their Parents Repay?

One rationale for why a family might take on Parent PLUS loans is that the child, who would become more educated as a result of the loan, could chip in for loan repayment. There is no accurate data available to track how often these adult children contribute to paying the monthly Parent PLUS bills, or a portion of them, but comparing Parent PLUS debt loads to adult children’s income would show how challenging it would be for the typical Parent PLUS child to assist their parent(s) with repayment. 

In Table 3 below, the average intergenerational loan debt—the parent’s loans and the child’s loans—is compared with the adult child’s income ten years after they earn their bachelor’s degree, reflecting a survey sample of students who graduated in 2007–08. Across all racial groups, the typical adult child’s annual income had not yet surpassed the original intergenerational debt amount ten years after graduating. Helping parents pay down their Parent PLUS loan debt appears challenging for Latino/a students in particular, whose families leave college with an average debt load (including Parent PLUS) of $77,000, compared with an average income of $62,000 ten years after graduating.

Table 3: TOTAL INTERGENERATIONAL DEBT COMPARED TO AVERAGE ANNUAL INCOME OF BACHELOR’S DEGREE RECIPIENTS WHOSE PARENTS TOOK OUT PARENT PLUS, TEN YEARS AFTER GRADUATION, BY RACE

```{r table3, include=TRUE, echo=FALSE, warning=FALSE}
########################################################
### This table is derived from the Baccalaureate &   ###
### Beyond Study (2008/18), accessible in Datalab    ###
### using table retrieval number hrygwq.             ###
### The row for Native American students is excluded ###
### due to small sample size.                        ###
########################################################

hrygwq <- read.csv("Powerstats hrygwq.csv", header=FALSE, skip=9, nrow=8)
hrygwq <- hrygwq %>% filter(V1 %in% c("American Indian or Alaska Native", "Race/ethnicity (with multiple)")==FALSE)

hrygwq$V2 <- as.numeric(hrygwq$V2)
hrygwq$V3 <- as.numeric(hrygwq$V3)
hrygwq$V4 <- as.numeric(hrygwq$V4)

names(hrygwq) <- c("Race", "Salary", "PLUS", "OtherLoans")
hrygwq$AllLoans <- hrygwq$PLUS + hrygwq$OtherLoans
hrygwq$Ratio <- hrygwq$AllLoans / hrygwq$Salary

hrygwq <- hrygwq %>% select(Race, PLUS, OtherLoans, AllLoans, Salary, Ratio)
names(hrygwq) <- c("Race", "Parent PLUS Balance", "Balance of All Other Loans for Education", "Total Intergenerational Debt", "Average Annual Earnings", "Ratio of Debt to Earnings")

hrygwq[c(2, 3, 4, 5, 6, 1), ]
```

A parent may face difficulty in Parent PLUS repayment, but so too may their child in repaying the rest of their federal loans. Moreover, it would be wrong to assume that Parent PLUS parents only enroll their children in degree programs that are certain to yield a high-paying job. Looking at enrollment data for students from Parent PLUS families reveals the following:

* Aggregated together, bachelor programs in culinary arts rank among the ten programs with the highest shares of students receiving Parent PLUS. 

* Two of the top ten colleges by the percentage of students receiving Parent PLUS are dramatic arts schools.

* Six of the ten colleges with the greatest average outstanding Parent PLUS loan balances—all over $67,000—are arts and design colleges. 

```{r note2, include=TRUE, echo=FALSE, warning=FALSE}
# These are found in the code chunks below, corresponding to tables A1 through A3.  
```

The data sadly confirm the conventional wisdom that these are not well-paying fields. Of credential earners who had started college in 2011–12 and weren’t still enrolled in 2017, those majoring in “visual and performing arts” and “personal and culinary services” ranked in the bottom five for annual income out of thirty-two fields of study, with annual salaries of $28,929 and $23,885, respectively. (For more data, see Appendix 1 Tables A1 through A4.) 

```{r tableA1, include=TRUE, echo=FALSE, warning=FALSE}
#######################################################
### Here we are interested in how PLUS is used at   ###
### different rates based on field of study. Our    ###
### data source is the College Scorecard program-   ###
### level dataset. The numerator is the number of   ###
### PLUS recipients in the most recent cohort, and  ###
### the denominator is the number of graduates by   ###
### program in the latest cohort. We aggregate      ###
### across all programs by field of study to obtain ###
### one ratio per combination of 4-digit CIP code   ###
### and credential level.                           ###
#######################################################

CSP <- fread("Most-Recent-Cohorts-Field-of-Study.csv", header=TRUE, select=c(
  "UNITID",                 # Unit ID for institution
  "CIPCODE",                # Classification of Instructional Programs (CIP) code for the field of study
  "CIPDESC",                # Text description of the field of study CIP Code
  "CREDLEV",                # Level of credential
  "CONTROL",                # Control of institution 
  "IPEDSCOUNT1",            # Number of awards to all students in year 1 of the pooled debt cohort
  "IPEDSCOUNT2",            # Number of awards to all students in year 2 of the pooled debt cohort
  "DEBT_ALL_PP_EVAL_N",     # Student recipient count for average/median Parent PLUS loan debt disbursed at this institution
  "DEBT_ALL_PP_EVAL_MEAN",  # Average Parent PLUS loan debt disbursed at this institution
  "DEBT_ALL_PP_EVAL_MDN",   # Median Parent PLUS loan debt disbursed at this institution
  "EARN_MDN_HI_2YR"         # Median earnings of graduates working and not enrolled 2 years after completing highest credential
)) %>% filter(CREDLEV <= 3) # This filters for undergraduate programs only. 

CSP$EARN_MDN_HI_2YR <- as.numeric(CSP$EARN_MDN_HI_2YR)
CSP$DEBT_ALL_PP_EVAL_MEAN <- as.numeric(CSP$DEBT_ALL_PP_EVAL_MEAN)
CSP$IPEDSCOUNT1 <- as.numeric(CSP$IPEDSCOUNT1)
CSP$IPEDSCOUNT2 <- as.numeric(CSP$IPEDSCOUNT2)
CSP$DEBT_ALL_PP_EVAL_N <- as.numeric(CSP$DEBT_ALL_PP_EVAL_N)
CSP$CIPCODE <- as.character(CSP$CIPCODE)

CSP$CIPCODE <- ifelse(nchar(CSP$CIPCODE) == 1, paste("0", CSP$CIPCODE, sep=""), CSP$CIPCODE)
CSP$CIPCODE <- ifelse(nchar(CSP$CIPCODE) == 2, paste("0", CSP$CIPCODE, sep=""), CSP$CIPCODE)
CSP$CIPCODE <- ifelse(nchar(CSP$CIPCODE) == 3, paste("0", CSP$CIPCODE, sep=""), CSP$CIPCODE)

CSP <- CSP %>% filter(is.na(IPEDSCOUNT1)==FALSE) 
CSP <- CSP %>% filter(is.na(IPEDSCOUNT2)==FALSE)
CSP <- CSP %>% filter(is.na(DEBT_ALL_PP_EVAL_N)==FALSE)
CSP$IPEDSCOUNT <- CSP$IPEDSCOUNT1 + CSP$IPEDSCOUNT2

tbl7 <- aggregate(data=CSP, cbind(IPEDSCOUNT, DEBT_ALL_PP_EVAL_N) ~ CIPCODE + CIPDESC + CREDLEV, FUN=sum)

tbl7$PLUSratio <- tbl7$DEBT_ALL_PP_EVAL_N / tbl7$IPEDSCOUNT

tbl7$CREDLEV2 <- rep(NA, nrow(tbl7))
tbl7$CREDLEV2[tbl7$CREDLEV==1] <- "Undergraduate Certificate or Diploma"
tbl7$CREDLEV2[tbl7$CREDLEV==2] <- "Associate Degree"
tbl7$CREDLEV2[tbl7$CREDLEV==3] <- "Bachelor's Degree"

tbl7 <- tbl7 %>% filter(IPEDSCOUNT > 200) %>% arrange(desc(PLUSratio)) %>% filter(duplicated(CIPDESC)==FALSE) 

head(tbl7, 10) %>% select(CIPCODE, CIPDESC, CREDLEV2, IPEDSCOUNT, DEBT_ALL_PP_EVAL_N, PLUSratio) %>% add_row(CIPCODE=NA, CIPDESC="Median 4-digit CIP code", CREDLEV2=NA, IPEDSCOUNT=NA, DEBT_ALL_PP_EVAL_N=NA, PLUSratio=median(tbl7$PLUSratio, na.rm=TRUE))
```

```{r tableA2, include=TRUE, echo=FALSE, warning=FALSE}
#######################################################
### Here we look for the institutions where the     ###
### greatest percentages of undergraduates receive  ###
### Parent PLUS.                                    ###
#######################################################

head(CSI3, 10) %>% select(INSTNM, PPLUS_PCT_LOW, PPLUS_PCT_HIGH, MN_EARN_WNE_P10) %>% add_row(INSTNM="Median U.S. institution", "PPLUS_PCT_LOW"=median(CSI3$PPLUS_PCT_LOW), "PPLUS_PCT_HIGH"=median(CSI3$PPLUS_PCT_HIGH), "MN_EARN_WNE_P10"=median(CSI3$MN_EARN_WNE_P10))
```

```{r tableA3, include=TRUE, echo=FALSE, warning=FALSE}
#######################################################
### Now we derive the list of institutions where    ###
### the average outstanding PLUS balance is         ###
### greatest.                                       ###
#######################################################

CSI3.5 <- CSI %>% filter(is.na(LPPPLUS_AMT)==FALSE) %>% filter(is.na(LPPPLUS_CNT)==FALSE) %>% filter(is.na(MN_EARN_WNE_P10)==FALSE) %>% filter(LPPPLUS_CNT >= 500)
CSI3.5$`Average outstanding Parent PLUS balance` <- CSI3.5$LPPPLUS_AMT / CSI3.5$LPPPLUS_CNT 
CSI3.5 <- CSI3.5 %>% arrange(desc(`Average outstanding Parent PLUS balance`))
head(CSI3.5, 10) %>% select(INSTNM, `Average outstanding Parent PLUS balance`, MN_EARN_WNE_P10) %>% add_row(INSTNM="Median U.S. institution", "Average outstanding Parent PLUS balance"=median(CSI3.5$`Average outstanding Parent PLUS balance`), "MN_EARN_WNE_P10"=median(CSI3.5$MN_EARN_WNE_P10))
```

```{r tableA4, include=TRUE, echo=FALSE, warning=FALSE}
#######################################################
### This table is derived from the Beginning        ###
### Postsecondary Students Study (2012/17), table   ###
### retrieval number #yfowbb.                       ###
#######################################################

yfowbb <- read.csv("Powerstats yfowbb.csv", header=FALSE, skip=9, nrow=48)
yfowbb$V2 <- as.numeric(yfowbb$V2)
yfowbb <- yfowbb %>% filter(is.na(V2)==FALSE) %>% arrange(V2)
names(yfowbb) <- c("Field of study", "Annual salary in 2017")
yfowbb[c(c(1:15), c(17:33), 16), ]
```

## Repayment Struggles

Parent PLUS loan use exhibits a concerning pattern where an outsized share of those who would struggle to repay these loans take them on. But do families indeed struggle to repay, and to what extent? For years, researchers have had only limited data to answer this question. The U.S. Department of Education has previously estimated that around one in eleven Parent PLUS borrowers will default, and research suggests that this is closer to one in five for the parents of Black students receiving Parent PLUS loans. But this information does not reveal anything about how much repayment outcomes vary by institution, and until recently, the best available survey data to figure that out relies on a sample of students who first enrolled in college a decade and a half ago.

In 2021, however, the Department of Education released an update to the College Scorecard that significantly improves public access to data on Parent PLUS repayment, both in terms of borrowers’ repayment statuses and borrowers’ balances over time. This section of the report provides the first major examination of these Parent PLUS repayment data since their release. 

One useful way to assess difficulties in student loan repayment is to look at the ratio of outstanding loan debt to initial loan principal over a series of years (the so-called dollar-based repayment rates). Figure 4 looks at this debt-to-principal ratio for Parent PLUS borrowers for cohorts who entered repayment 1, 4, 5, and 10 years prior, as provided by the College Scorecard. Aggregating the top fifty institutions for Black students’ shares of enrollment and aggregating the top fifty institutions for white students’ shares of enrollment, we observe a strong contrast. At the ten-year mark, the length of a standard Parent PLUS repayment plan, the parents of Parent PLUS recipients at the top colleges for Black enrollment still owe 96 percent of their principal, versus 47 percent among those at the top colleges for white enrollment. In other words, if two families borrowed the same amount and had repayment patterns that are typical for their college, then after ten years the parents of a child attending a top-fifty institution for Black enrollment owe twice as much as the parents of a child attending a top-fifty institution for white enrollment. 

```{r stat21, include=TRUE, echo=FALSE, warning=FALSE}
#########################################################
### Now we leverage a set of College Scorecard        ###
### variables on dollar-based repayment rates (DBRR). ###
### These variables are available for cohorts of      ###
### borrowers who entered repayment 1, 4, 5, 10, and  ###
### 20 years ago. This is an analysis by race, and    ###
### since borrowing patterns have changed for Black   ###
### and Latino borrowers, especially in the past 15   ###
### years, we use the 1, 4, 5, and 10 year cohorts    ###
### while ignoring the 20 year cohort for now.        ###
#########################################################

#########################################################
### The numerators represent the Parent PLUS loan     ###
### balance for the cohort at the last time of        ###
### measurement by the Education Department. The      ###
### denominators represent the original principal.    ###
#########################################################

#########################################################
### First we loan in the data and format as numbers.  ###
#########################################################

CSI9 <- fread("Most-Recent-Cohorts-Institution.csv", header=TRUE, select=c(
  "UNITID",           # Unit ID for institution
  "INSTNM",           # Institution name
  "OPEID6",           # 6-digit OPE ID for institution
  "HBCU",             # Flag for Historically Black College and University
  "CONTROL",          # Control of institution
  "DBRR1_PP_UG_N",    # Undergraduate Parent PLUS Loan dollar-based 1-year repayment rate borrower count
  "DBRR4_PP_UG_N",    # Undergraduate Parent PLUS Loan dollar-based 4-year repayment rate borrower count
  "DBRR5_PP_UG_N",    # Undergraduate Parent PLUS Loan dollar-based 5-year repayment rate borrower count
  "DBRR10_PP_UG_N",   # Undergraduate Parent PLUS Loan dollar-based 10-year repayment rate borrower count
  "DBRR1_PP_UG_NUM",  # Undergraduate Parent PLUS Loan dollar-based 1-year repayment rate numerator
  "DBRR1_PP_UG_DEN",  # Undergraduate Parent PLUS Loan dollar-based 1-year repayment rate denominator
  "DBRR4_PP_UG_NUM",  # Undergraduate Parent PLUS Loan dollar-based 4-year repayment rate numerator
  "DBRR4_PP_UG_DEN",  # Undergraduate Parent PLUS Loan dollar-based 4-year repayment rate denominator
  "DBRR5_PP_UG_NUM",  # Undergraduate Parent PLUS Loan dollar-based 5-year repayment rate numerator
  "DBRR5_PP_UG_DEN",  # Undergraduate Parent PLUS Loan dollar-based 5-year repayment rate denominator
  "DBRR10_PP_UG_NUM", # Undergraduate Parent PLUS Loan dollar-based 10-year repayment rate numerator
  "DBRR10_PP_UG_DEN"  # Undergraduate Parent PLUS Loan dollar-based 10-year repayment rate denominator
)) %>% filter(duplicated(OPEID6)==FALSE) # This filtering is necessary because otherwise debt amounts may be double-counted. 

CSI9$DBRR1_PP_UG_N <- as.numeric(CSI9$DBRR1_PP_UG_N) 
CSI9$DBRR1_PP_UG_NUM <- as.numeric(CSI9$DBRR1_PP_UG_NUM) 
CSI9$DBRR1_PP_UG_DEN <- as.numeric(CSI9$DBRR1_PP_UG_DEN)
CSI9$DBRR4_PP_UG_N <- as.numeric(CSI9$DBRR4_PP_UG_N) 
CSI9$DBRR4_PP_UG_NUM <- as.numeric(CSI9$DBRR4_PP_UG_NUM) 
CSI9$DBRR4_PP_UG_DEN <- as.numeric(CSI9$DBRR4_PP_UG_DEN)
CSI9$DBRR5_PP_UG_N <- as.numeric(CSI9$DBRR5_PP_UG_N) 
CSI9$DBRR5_PP_UG_NUM <- as.numeric(CSI9$DBRR5_PP_UG_NUM) 
CSI9$DBRR5_PP_UG_DEN <- as.numeric(CSI9$DBRR5_PP_UG_DEN)
CSI9$DBRR10_PP_UG_N <- as.numeric(CSI9$DBRR10_PP_UG_N) 
CSI9$DBRR10_PP_UG_NUM <- as.numeric(CSI9$DBRR10_PP_UG_NUM) 
CSI9$DBRR10_PP_UG_DEN <- as.numeric(CSI9$DBRR10_PP_UG_DEN) 

#########################################################
### Now we filter out institutions with incomplete    ###
### data.                                             ###
#########################################################

CSI9.3 <- CSI9 %>% filter(is.na(CSI9$DBRR1_PP_UG_NUM)==FALSE
                          &
                          is.na(CSI9$DBRR1_PP_UG_DEN)==FALSE
                          &
                          is.na(CSI9$DBRR4_PP_UG_NUM)==FALSE
                          &
                          is.na(CSI9$DBRR4_PP_UG_DEN)==FALSE
                          &
                          is.na(CSI9$DBRR5_PP_UG_NUM)==FALSE
                          &
                          is.na(CSI9$DBRR5_PP_UG_DEN)==FALSE
                          &
                          is.na(CSI9$DBRR10_PP_UG_NUM)==FALSE
                          &
                          is.na(CSI9$DBRR10_PP_UG_DEN)==FALSE)

#########################################################
### We also apply minimum thresholds of 30 borrowers  ###
### for each cohort.                                  ###
#########################################################

CSI9.3 <- CSI9.3 %>% filter(DBRR1_PP_UG_N >= 30 
                            & 
                            DBRR4_PP_UG_N >= 30
                            &
                            DBRR5_PP_UG_N >= 30
                            & 
                            DBRR10_PP_UG_N >= 30)

##################################################################
### Now we pull in data on enrollment by race and rank schools ###
### by Black and white enrollment shares. We filter for at     ###
### minimum 1,000 enrolled undergraduates.                     ###
##################################################################

effy2020 <- fread("effy2020.csv", header=TRUE, select=c(
  "UNITID", 
  "EFFYALEV", 
  "EFYTOTLT", 
  "EFYBKAAT", 
  "EFYWHITT"
)) %>% filter(EFFYALEV==2) %>% filter(EFYTOTLT > 1000)

effy2020$EFYBKAAT[is.na(effy2020$EFYBKAAT)] <- 0
effy2020$EFYWHITT[is.na(effy2020$EFYWHITT)] <- 0
effy2020$EFYTOTLT[is.na(effy2020$EFYTOTLT)] <- 0

effy2020$`Black share of undergraduates` <- effy2020$EFYBKAAT / effy2020$EFYTOTLT
effy2020$`White share of undergraduates` <- effy2020$EFYWHITT / effy2020$EFYTOTLT
effy2020 <- effy2020 %>% select(UNITID, `Black share of undergraduates`, `White share of undergraduates`)
CSI9.3 <- inner_join(x=CSI9.3, y=effy2020, by="UNITID")

CSI9.3$`Rank of Black share` <- rank(CSI9.3$`Black share of undergraduates`, ties.method = "first")
CSI9.3$`Rank of white share` <- rank(CSI9.3$`White share of undergraduates`, ties.method = "first")

CSI9.3$`Top 50 for Black share` <- ifelse(CSI9.3$`Rank of Black share` > (nrow(CSI9.3) - 50), 1, 0)
CSI9.3$`Top 50 for white share` <- ifelse(CSI9.3$`Rank of white share` > (nrow(CSI9.3) - 50), 1, 0)

CSI9.3$`Group` <- ifelse(CSI9.3$`Top 50 for Black share`==1, "Top 50 for Black share of undergrads", ifelse(CSI9.3$`Top 50 for white share`==1, "Top 50 for white share of undergrads", NA))

CSI9.3 <- CSI9.3 %>% filter(is.na(Group)==FALSE)

#########################################################
### Now we sum all the numerator and denominator      ###
### variables by group and find each cohort's         ###
### dollar-based repayment rate.                      ###
#########################################################

tblD2 <- aggregate(data=CSI9.3, cbind(DBRR1_PP_UG_NUM, 
                                     DBRR1_PP_UG_DEN, 
                                     DBRR4_PP_UG_NUM, 
                                     DBRR4_PP_UG_DEN, 
                                     DBRR5_PP_UG_NUM, 
                                     DBRR5_PP_UG_DEN, 
                                     DBRR10_PP_UG_NUM, 
                                     DBRR10_PP_UG_DEN) ~ Group, FUN=sum)
tblD2$DBRR1_PP_UG_RATE <- tblD2$DBRR1_PP_UG_NUM / tblD2$DBRR1_PP_UG_DEN
tblD2$DBRR4_PP_UG_RATE <- tblD2$DBRR4_PP_UG_NUM / tblD2$DBRR4_PP_UG_DEN
tblD2$DBRR5_PP_UG_RATE <- tblD2$DBRR5_PP_UG_NUM / tblD2$DBRR5_PP_UG_DEN
tblD2$DBRR10_PP_UG_RATE <- tblD2$DBRR10_PP_UG_NUM / tblD2$DBRR10_PP_UG_DEN 

##########################################################
### Next we show the aggregate repayment rate by group ###
### for the 10-year cohort.                            ###
##########################################################

data.frame(tblD2$Group, tblD2$DBRR10_PP_UG_RATE) 
```

Figure 4: RATIO OF OUTSTANDING PARENT PLUS LOAN BALANCE TO ORIGINAL PRINCIPAL TEN YEARS OUT, FOR 50 TOP BLACK ENROLLMENT AND 50 TOP WHITE ENROLLMENT SCHOOLS

```{r figure4, include=TRUE, echo=FALSE, warning=FALSE}
#########################################################
### Returning to the pre-aggregation data, we plot    ###
### repayment rates for all institutions in each      ###
### top-50 group.                                     ###
#########################################################

CSI9.3$DBRR1_PP_UG_RATE <- CSI9.3$DBRR1_PP_UG_NUM / CSI9.3$DBRR1_PP_UG_DEN
CSI9.3$DBRR4_PP_UG_RATE <- CSI9.3$DBRR4_PP_UG_NUM / CSI9.3$DBRR4_PP_UG_DEN
CSI9.3$DBRR5_PP_UG_RATE <- CSI9.3$DBRR5_PP_UG_NUM / CSI9.3$DBRR5_PP_UG_DEN
CSI9.3$DBRR10_PP_UG_RATE <- CSI9.3$DBRR10_PP_UG_NUM / CSI9.3$DBRR10_PP_UG_DEN 

tblN <- data.frame("UNITID"=rep(CSI9.3$UNITID, 5), 
                   "INSTNM"=rep(CSI9.3$INSTNM, 5), 
                   "Group"=rep(CSI9.3$Group, 5),
                   "Year"=c(rep(0, 100), rep(1, 100), rep(4, 100), rep(5, 100), rep(10, 100)), 
                   "Ratio"=c(rep(1, 100), CSI9.3$DBRR1_PP_UG_RATE, CSI9.3$DBRR4_PP_UG_RATE, CSI9.3$DBRR5_PP_UG_RATE, CSI9.3$DBRR10_PP_UG_RATE)
)

ggplot(data=tblN, mapping=aes(x=Year, group=INSTNM)) + geom_line(data=tblN, aes(y=Ratio, color=Group), alpha=0.3, size=0.5) + geom_point(data=tblN, aes(y=Ratio, color=Group), alpha=0.3, size=0.5) + scale_x_continuous(breaks=c(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10), labels = scales::number_format(accuracy = 1)) + labs(y = "Ratio of outstanding balance to original disbursement", x = "Years from repayment start") + scale_y_continuous(lim=c(0, 1.4)) 
```

Even for smaller Parent PLUS loans, Black parents struggle significantly more to repay than do white parents. At ten years from the start of repayment, no institution in the top fifty for white students’ share of undergraduate enrollment sees parents of its attendees burdened by more than two-thirds of the principal remaining. By contrast, at this same point in time, parents of attendees at forty-six of the top fifty institutions for Black students’ share of undergraduate enrollment have at least two-thirds of the principal remaining, including fourteen schools where the average original principal was less than $10,000. (See Figure A1 in Appendix 1.)

```{r figureA1, include=TRUE, echo=FALSE, warning=FALSE}
##########################################################
### Here we focus just on the 10-year cohort, starting ###
### over with the filtering and the ranking, and then  ###
### plotting how repayment at 10 years differs by      ###
### top-50 group.                                      ###
#########################################################

CSI9.4 <- CSI9 %>% filter(is.na(CSI9$DBRR10_PP_UG_NUM)==FALSE
                          &
                          is.na(CSI9$DBRR10_PP_UG_DEN)==FALSE)

CSI9.4 <- CSI9.4 %>% filter(DBRR10_PP_UG_N >= 30)

CSI9.4$AveragePLUS <- CSI9.4$DBRR10_PP_UG_DEN / CSI9.4$DBRR10_PP_UG_N
CSI9.4$Ratio <- CSI9.4$DBRR10_PP_UG_NUM / CSI9.4$DBRR10_PP_UG_DEN

CSI9.4 <- inner_join(x=CSI9.4, y=effy2020, by="UNITID")

CSI9.4$`Rank of Black share` <- rank(CSI9.4$`Black share of undergraduates`, ties.method = "first")
CSI9.4$`Rank of white share` <- rank(CSI9.4$`White share of undergraduates`, ties.method = "first")

CSI9.4$`Top 50 for Black share` <- ifelse(CSI9.4$`Rank of Black share` > (nrow(CSI9.4) - 50), 1, 0)
CSI9.4$`Top 50 for white share` <- ifelse(CSI9.4$`Rank of white share` > (nrow(CSI9.4) - 50), 1, 0)

CSI9.4$`Group` <- ifelse(CSI9.4$`Top 50 for Black share`==1, "Top 50 for Black share of undergrads", ifelse(CSI9.4$`Top 50 for white share`==1, "Top 50 for white share of undergrads", NA))

CSI9.4 <- CSI9.4 %>% filter(is.na(Group)==FALSE)

ggplot(data=CSI9.4, mapping=aes(x=AveragePLUS, y=Ratio)) + geom_point(alpha=0.3) + facet_grid (~ Group) + labs(x="Average PLUS loan amount at origination for 10-year cohort", y="Ratio of outstanding balance to original principal at 10 years") + scale_x_continuous(lim=c(0, 40000), labels=scales::dollar_format()) + scale_y_continuous(lim=c(0, 1.2)) 
```

These results display—in no uncertain terms—who has wealth and income in this country, and who doesn't.

The College Scorecard also provides data on borrowers’ default and repayment status (“borrower-based repayment rates”) for a smaller set of institutions, suppressing data for institutions where the borrower population is not large. The data only span borrowers’ statuses a few years into repayment, yet they suggest heavily that Black families comprise an outsized share of families falling into delinquency and default, unable to pay down their balances. 

For 1,920 institutions, the College Scorecard provides data on the percentage of Parent PLUS borrowers making progress on their loans after three years, which means the families are successfully paying down the principal amount. Sixty-eight institutions show 10 percent of parents or fewer making progress after three years; fifty-nine of them are HBCUs. 

```{r stat21.1, include=TRUE, echo=FALSE, warning=FALSE}
#########################################################
### Next we use a set of variables that represent     ###
### borrower-based repayment rates (BBRR).            ###
#########################################################

CSI6 <- fread("Most-Recent-Cohorts-Institution.csv", header=TRUE, select=c(
  "UNITID",                   # Unit ID for institution 
  "OPEID6",                   # 6-digit OPE ID for institution
  "INSTNM",                   # Institution name
  "HBCU",                     # Flag for Historically Black College and University
  "CONTROL",                  # Control of institution
  "BBRR2_PP_UG_N",            # Undergraduate student Parent PLUS Loan borrower-based 2-year borrower count
  "BBRR3_PP_UG_N",            # Undergraduate student Parent PLUS Loan borrower-based 3-year borrower count
  "BBRR2_PP_UG_DFLT",         # Percentage of undergraduate student Parent PLUS Loan borrowers in default after 2 years
  "BBRR3_PP_UG_DFLT",         # Percentage of undergraduate student Parent PLUS Loan borrowers in default after 3 years
  "BBRR3_PP_UG_MAKEPROG",     # Percentage of undergraduate student Parent PLUS Loan borrowers making progress after 3 years
  "BBRR3_PP_UGCOMP_N",        # Undergraduate completer undergraduate student Parent PLUS Loan borrower-based 3-year borrower count
  "BBRR3_PP_UGNOCOMP_N",      # Undergraduate non-completer undergraduate student Parent PLUS Loan borrower-based 3-year borrower count
  "BBRR3_PP_UGCOMP_DFLT",	    # Percentage of undergraduate completer undergraduate student Parent PLUS Loan borrowers in default after 3 years
  "BBRR3_PP_UGNOCOMP_DFLT",   # Percentage of undergraduate non-completer undergraduate student Parent PLUS Loan borrowers in default after 3 years
  "BBRR3_PP_PELL_N",	        # Pell Grant recipient student Parent PLUS Loan borrower-based 3-year borrower count
  "BBRR3_PP_NOPELL_N",	      # Non-Pell Grant recipient student Parent PLUS Loan borrower-based 3-year borrower count
  "BBRR3_PP_PELL_DFLT",	      # Percentage of Pell Grant recipient student Parent PLUS Loan borrowers in default after 3 years
  "BBRR3_PP_NOPELL_DFLT"      # Percentage of non-Pell Grant recipient student Parent PLUS Loan borrowers in default after 3 years
)) %>% filter(duplicated(OPEID6)==FALSE) # This filtering is necessary because otherwise borrowers may be double-counted. 

#########################################################
### First we set the recipient count variables as     ###
### numbers, but not the default rate variables (this ###
### will be explained shortly).                       ###
#########################################################

CSI6$BBRR2_PP_UG_N <- as.numeric(CSI6$BBRR2_PP_UG_N)
CSI6$BBRR3_PP_UG_N <- as.numeric(CSI6$BBRR3_PP_UG_N)
CSI6$BBRR3_PP_UGCOMP_N <- as.numeric(CSI6$BBRR3_PP_UGCOMP_N)
CSI6$BBRR3_PP_UGNOCOMP_N <- as.numeric(CSI6$BBRR3_PP_UGNOCOMP_N)
CSI6$BBRR3_PP_PELL_N <- as.numeric(CSI6$BBRR3_PP_PELL_N)
CSI6$BBRR3_PP_NOPELL_N <- as.numeric(CSI6$BBRR3_PP_NOPELL_N)

CSI6$OPEID6 <- as.character(CSI6$OPEID6)
CSI6$OPEID6 <- ifelse(nchar(CSI6$OPEID6) == 2, paste("0", CSI6$OPEID6, sep=""), CSI6$OPEID6)
CSI6$OPEID6 <- ifelse(nchar(CSI6$OPEID6) == 3, paste("0", CSI6$OPEID6, sep=""), CSI6$OPEID6)
CSI6$OPEID6 <- ifelse(nchar(CSI6$OPEID6) == 4, paste("0", CSI6$OPEID6, sep=""), CSI6$OPEID6)
CSI6$OPEID6 <- ifelse(nchar(CSI6$OPEID6) == 5, paste("0", CSI6$OPEID6, sep=""), CSI6$OPEID6)

########################################################################
### Now we need to set the numeric percentage variables as numbers.  ###
### Many of them are listed as intervals, in which case we           ###
### manually assign the midpoint value as a stand-in.                ### 
########################################################################

conversionsDF <- data.frame("Character.Entry" = c("PrivacySuppressed", "NULL"), "Numeric.Entry"=c(NA, NA))
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "<=0.01", Numeric.Entry = 0)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "<=0.02", Numeric.Entry = 0.01)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "<=0.05", Numeric.Entry = 0.025)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "<=0.10", Numeric.Entry = 0.05) 
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "<=0.20", Numeric.Entry = 0.1)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.01", Numeric.Entry = 0.01)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.02", Numeric.Entry = 0.02)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.03", Numeric.Entry = 0.03)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.04", Numeric.Entry = 0.04)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.05", Numeric.Entry = 0.05)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.06", Numeric.Entry = 0.06)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.07", Numeric.Entry = 0.07)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.08", Numeric.Entry = 0.08)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.09", Numeric.Entry = 0.09)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.10", Numeric.Entry = 0.10)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.11", Numeric.Entry = 0.11)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.12", Numeric.Entry = 0.12)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.13", Numeric.Entry = 0.13)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.14", Numeric.Entry = 0.14)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.15", Numeric.Entry = 0.15)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.16", Numeric.Entry = 0.16)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.17", Numeric.Entry = 0.17)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.18", Numeric.Entry = 0.18)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.19", Numeric.Entry = 0.19)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.20", Numeric.Entry = 0.20)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.21", Numeric.Entry = 0.21)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.22", Numeric.Entry = 0.22)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.23", Numeric.Entry = 0.23)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.24", Numeric.Entry = 0.24)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.25", Numeric.Entry = 0.25)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.26", Numeric.Entry = 0.26)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.27", Numeric.Entry = 0.27)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.28", Numeric.Entry = 0.28)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.29", Numeric.Entry = 0.29)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.30", Numeric.Entry = 0.30)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.31", Numeric.Entry = 0.31)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.32", Numeric.Entry = 0.32)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.33", Numeric.Entry = 0.33)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.34", Numeric.Entry = 0.34)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.35", Numeric.Entry = 0.35)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.36", Numeric.Entry = 0.36)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.37", Numeric.Entry = 0.37)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.38", Numeric.Entry = 0.38)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.39", Numeric.Entry = 0.39)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.03-0.04", Numeric.Entry = 0.035)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.05-0.06", Numeric.Entry = 0.055) 
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.05-0.09", Numeric.Entry = 0.07)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.07-0.08", Numeric.Entry = 0.075)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.09-0.10", Numeric.Entry = 0.095)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.10-0.14", Numeric.Entry = 0.12)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.10-0.19", Numeric.Entry = 0.145)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.11-0.12", Numeric.Entry = 0.115)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.13-0.14", Numeric.Entry = 0.135)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.15-0.16", Numeric.Entry = 0.155)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.17-0.18", Numeric.Entry = 0.175)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.15-0.19", Numeric.Entry = 0.17)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.19-0.20", Numeric.Entry = 0.195)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.20-0.24", Numeric.Entry = 0.22)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.20-0.29", Numeric.Entry = 0.245)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.20-0.39", Numeric.Entry = 0.295)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.21-0.22", Numeric.Entry = 0.215)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.23-0.24", Numeric.Entry = 0.235)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.25-0.26", Numeric.Entry = 0.255)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.25-0.29", Numeric.Entry = 0.27)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.27-0.28", Numeric.Entry = 0.275)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.29-0.30", Numeric.Entry = 0.295)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.30-0.34", Numeric.Entry = 0.32)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.30-0.39", Numeric.Entry = 0.345)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.31-0.32", Numeric.Entry = 0.315)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.33-0.34", Numeric.Entry = 0.335)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.40-0.44", Numeric.Entry = 0.42)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.40-0.49", Numeric.Entry = 0.445)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.40-0.59", Numeric.Entry = 0.495)
conversionsDF <- conversionsDF %>% add_row(Character.Entry = "0.60-0.79", Numeric.Entry = 0.695)

conversionsDF.BBRR2_PP_UG_DFLT <- conversionsDF
conversionsDF.BBRR3_PP_UG_DFLT <- conversionsDF
conversionsDF.BBRR3_PP_UG_MAKEPROG <- conversionsDF
conversionsDF.BBRR3_PP_UGCOMP_DFLT <- conversionsDF
conversionsDF.BBRR3_PP_UGNOCOMP_DFLT <- conversionsDF
conversionsDF.BBRR3_PP_PELL_DFLT <- conversionsDF
conversionsDF.BBRR3_PP_NOPELL_DFLT <- conversionsDF

names(conversionsDF.BBRR2_PP_UG_DFLT) <- c("BBRR2_PP_UG_DFLT", "BBRR2_PP_UG_DFLT.modified")
names(conversionsDF.BBRR3_PP_UG_DFLT) <- c("BBRR3_PP_UG_DFLT", "BBRR3_PP_UG_DFLT.modified")
names(conversionsDF.BBRR3_PP_UG_MAKEPROG) <- c("BBRR3_PP_UG_MAKEPROG", "BBRR3_PP_UG_MAKEPROG.modified")
names(conversionsDF.BBRR3_PP_UGCOMP_DFLT) <- c("BBRR3_PP_UGCOMP_DFLT", "BBRR3_PP_UGCOMP_DFLT.modified")
names(conversionsDF.BBRR3_PP_UGNOCOMP_DFLT) <- c("BBRR3_PP_UGNOCOMP_DFLT", "BBRR3_PP_UGNOCOMP_DFLT.modified")
names(conversionsDF.BBRR3_PP_PELL_DFLT) <- c("BBRR3_PP_PELL_DFLT", "BBRR3_PP_PELL_DFLT.modified")
names(conversionsDF.BBRR3_PP_NOPELL_DFLT) <- c("BBRR3_PP_NOPELL_DFLT", "BBRR3_PP_NOPELL_DFLT.modified")

CSI6 <- left_join(x=CSI6, y=conversionsDF.BBRR2_PP_UG_DFLT, by="BBRR2_PP_UG_DFLT")
CSI6 <- left_join(x=CSI6, y=conversionsDF.BBRR3_PP_UG_DFLT, by="BBRR3_PP_UG_DFLT")
CSI6 <- left_join(x=CSI6, y=conversionsDF.BBRR3_PP_UG_MAKEPROG, by="BBRR3_PP_UG_MAKEPROG")
CSI6 <- left_join(x=CSI6, y=conversionsDF.BBRR3_PP_UGCOMP_DFLT, by="BBRR3_PP_UGCOMP_DFLT")
CSI6 <- left_join(x=CSI6, y=conversionsDF.BBRR3_PP_UGNOCOMP_DFLT, by="BBRR3_PP_UGNOCOMP_DFLT")
CSI6 <- left_join(x=CSI6, y=conversionsDF.BBRR3_PP_PELL_DFLT, by="BBRR3_PP_PELL_DFLT")
CSI6 <- left_join(x=CSI6, y=conversionsDF.BBRR3_PP_NOPELL_DFLT, by="BBRR3_PP_NOPELL_DFLT")

#####################################################################
### Now we link in data on the distributions of students by race. ### 
#####################################################################

effy <- fread("effy2020.csv", header=TRUE, select=c(
  "UNITID",     # Unique identification number of the institution
  "EFFYALEV",   # Level and degree/certificate-seeking status of student
  "EFYTOTLT",   # Grand total
  "EFYBKAAT",   # Black or African American total
  "EFYHISPT"    # Hispanic or Latino total
)) %>% filter(EFFYALEV==2) # All students, Undergraduate total
hd2020 <- fread("hd2020.csv", header=TRUE, select=c("UNITID", "OPEID"))
effy <- left_join(x=effy, y=hd2020, by="UNITID")
effy$OPEID <- as.character(effy$OPEID)
effy$OPEID <- ifelse(nchar(effy$OPEID) == 2, paste("0", effy$OPEID, sep=""), effy$OPEID)
effy$OPEID <- ifelse(nchar(effy$OPEID) == 3, paste("0", effy$OPEID, sep=""), effy$OPEID)
effy$OPEID <- ifelse(nchar(effy$OPEID) == 4, paste("0", effy$OPEID, sep=""), effy$OPEID)
effy$OPEID <- ifelse(nchar(effy$OPEID) == 5, paste("0", effy$OPEID, sep=""), effy$OPEID)
effy$OPEID <- ifelse(nchar(effy$OPEID) == 6, paste("0", effy$OPEID, sep=""), effy$OPEID)
effy$OPEID <- ifelse(nchar(effy$OPEID) == 7, paste("0", effy$OPEID, sep=""), effy$OPEID)
effy$OPEID6 <- substr(effy$OPEID, 1, 6)

effy <- aggregate(data=effy, cbind(EFYTOTLT, EFYBKAAT, EFYHISPT) ~ OPEID6, FUN=sum)
effy$`Black share of undergraduates` <- effy$EFYBKAAT / effy$EFYTOTLT
effy$`Hispanic share of undergraduates` <- effy$EFYHISPT / effy$EFYTOTLT
effy <- effy %>% select(OPEID6, `Black share of undergraduates`, `Hispanic share of undergraduates`)

CSI6 <- left_join(x=CSI6, y=effy, by="OPEID6")

#########################################################
### These lines and the following code chunks will    ###
### now leverage this dataframe.                      ### 
#########################################################

CSI6.3 <- CSI6 %>% filter(is.na(BBRR3_PP_UG_MAKEPROG.modified)==FALSE) %>% filter(BBRR3_PP_UG_N >= 30)
tbl211 <- CSI6.3 %>% select(INSTNM, 
                            CONTROL, 
                            HBCU,
                            BBRR3_PP_UG_MAKEPROG, 
                            BBRR3_PP_UG_MAKEPROG.modified, 
                            `Black share of undergraduates`) 
tbl211 <- tbl211 %>% arrange(BBRR3_PP_UG_MAKEPROG.modified) 
tbl211 <- tbl211 %>% filter(BBRR3_PP_UG_MAKEPROG.modified < 0.1)
paste("The number of institutions where 10% of fewer of parents make progress after 3 years is", nrow(tbl211))
tbl211$HBCU <- as.numeric(tbl211$HBCU)
paste("The number of HBCUs in this set is", sum(tbl211$HBCU))
```

Among institutions with sufficient data in the College Scorecard, the median Parent PLUS default rate three years after borrowers enter repayment is 7 percent, but there is wide variation by college. Default rates can be high even within just a few years of entering repayment, and nowhere is this more true than at HBCUs. 

```{r stat21.3, include=TRUE, echo=FALSE, warning=FALSE}
paste("The median default rate after 3 years is", median(CSI6$BBRR3_PP_UG_DFLT.modified, na.rm=TRUE)) 
```

At Miles College, Lane College, and Philander Smith College, within two years of the start of repayment more than 20 percent of Parent PLUS borrowers are in default, exceeding 30 percent by the third year.

```{r stat22, include=TRUE, echo=FALSE, warning=FALSE}
#########################################################
### Using this same dataset, we now find the          ###
### institutions with the highest default rates in    ###
### their 2- and 3-year cohorts. We apply a minimum   ###
### of 100 borrowers per cohort.                      ###
#########################################################

tbl47 <- CSI6 %>% select(INSTNM, 
                         CONTROL, 
                         HBCU, 
                         BBRR2_PP_UG_N, 
                         BBRR3_PP_UG_N, 
                         BBRR2_PP_UG_DFLT, 
                         BBRR3_PP_UG_DFLT, 
                         BBRR2_PP_UG_DFLT.modified, 
                         BBRR3_PP_UG_DFLT.modified)

tbl47 <- tbl47 %>% filter(is.na(BBRR2_PP_UG_DFLT.modified)==FALSE
                          & is.na(BBRR3_PP_UG_DFLT.modified)==FALSE
                          & BBRR2_PP_UG_N >= 100
                          & BBRR3_PP_UG_N >= 100) 
tbl47 <- tbl47 %>% arrange(desc(BBRR3_PP_UG_DFLT.modified + BBRR2_PP_UG_DFLT.modified))
head(tbl47, 50) %>% select(INSTNM, HBCU, BBRR2_PP_UG_DFLT, BBRR3_PP_UG_DFLT, BBRR2_PP_UG_DFLT.modified, BBRR3_PP_UG_DFLT.modified) 
```

HBCUs make up 29 of the 76 institutions where, within three years of the start of repayment, more than 20 percent of families default on their Parent PLUS loan.

```{r stat23, include=TRUE, echo=FALSE, warning=FALSE}
#########################################################
### Now we look for the institutions with a default   ###
### rate above 20% for the 3-year cohort. We again    ###
### apply a minimum threshold of 100 borrowers.       ###
#########################################################

tbl48 <- CSI6 %>% select(INSTNM, 
                         CONTROL, 
                         HBCU, 
                         BBRR3_PP_UG_N, 
                         BBRR3_PP_UG_DFLT, 
                         BBRR3_PP_UG_DFLT.modified)
tbl48$HBCU <- as.numeric(tbl48$HBCU)

tbl48 <- tbl48 %>% filter(is.na(BBRR3_PP_UG_DFLT.modified)==FALSE
                          & BBRR3_PP_UG_N >= 100) 
tbl48 <- tbl48 %>% arrange(desc(BBRR3_PP_UG_DFLT.modified))
tbl48 <- tbl48 %>% select(INSTNM, HBCU, BBRR3_PP_UG_DFLT, BBRR3_PP_UG_DFLT.modified)
tbl48 <- tbl48 %>% filter(BBRR3_PP_UG_DFLT.modified > 0.2)

paste("The number of institutions with a default rate above 20% is ", nrow(tbl48), ".", sep="")
paste("This includes ", sum(tbl48$HBCU), " HBCUs.", sep="")
```

Taken together, these results heavily suggest that Parent PLUS loan repayment is a far more significant burden for Black families than for white families relative to their means. 

In addition, the College Scorecard offers data on repayment statuses for some subgroups of students. These data show that two factors play key roles in parents’ default rates: whether the child completed their program and whether the family also received the Pell Grant. At the three-year mark, more than twice as many Parent PLUS-borrower parents of non-completers are in default (9.7 percent) as the Parent PLUS-borrower parents of completers (an estimated 4.8 percent). And at the three-year mark, nearly three times more than twice as many of the Parent PLUS-borrower parents of Pell recipients (an estimated 9.3 percent) had defaulted on their Parent PLUS loans as the Parent PLUS-borrower parents of students who did not receive the Pell Grant (an estimated 3.3 percent).

```{r stat24, include=TRUE, echo=FALSE, warning=FALSE}
#########################################################
### Now we focus on the BBRR variables for completers ###
### and non-completers. We are focusing on the        ###
### aggregate repayment rates, so we do not apply     ###
### minimum borrower threshods.                       ###
#########################################################

CSI6.5 <- CSI6 %>% filter(is.na(BBRR3_PP_UGCOMP_DFLT.modified)==FALSE
                          &
                          is.na(BBRR3_PP_UGNOCOMP_DFLT.modified)==FALSE)

CSI6.5$BBRR3_PP_UGCOMP_DFLT_N <- CSI6.5$BBRR3_PP_UGCOMP_DFLT.modified * CSI6.5$BBRR3_PP_UGCOMP_N
CSI6.5$BBRR3_PP_UGNOCOMP_DFLT_N <- CSI6.5$BBRR3_PP_UGNOCOMP_DFLT.modified * CSI6.5$BBRR3_PP_UGNOCOMP_N

share.of.noncompleters.parents.who.default <- sum(CSI6.5$BBRR3_PP_UGNOCOMP_DFLT_N, na.rm=TRUE) / sum(CSI6.5$BBRR3_PP_UGNOCOMP_N, na.rm=TRUE) 
paste("The share of noncompleters' parents who default is", percent(share.of.noncompleters.parents.who.default, accuracy=0.1)) 
```

```{r stat25, include=TRUE, echo=FALSE, warning=FALSE}
share.of.completers.parents.who.default <- sum(CSI6.5$BBRR3_PP_UGCOMP_DFLT_N, na.rm=TRUE) / sum(CSI6.5$BBRR3_PP_UGCOMP_N, na.rm=TRUE) 
paste("The share of completers' parents who default is", percent(share.of.completers.parents.who.default, accuracy=0.1)) 
```

```{r stat26, include=TRUE, echo=FALSE, warning=FALSE}
#########################################################
### Now we do the same for Pell recipients vs         ###
### non-recipients.                                   ###
#########################################################

CSI6.7 <- CSI6 %>% filter(is.na(BBRR3_PP_PELL_N)==FALSE
                          & is.na(BBRR3_PP_PELL_DFLT)==FALSE
                          & is.na(BBRR3_PP_NOPELL_N)==FALSE
                          & is.na(BBRR3_PP_NOPELL_DFLT)==FALSE)

CSI6.7$BBRR3_PP_PELL_DFLT_N <- CSI6.7$BBRR3_PP_PELL_DFLT.modified * CSI6.7$BBRR3_PP_PELL_N
CSI6.7$BBRR3_PP_NOPELL_DFLT_N <- CSI6.7$BBRR3_PP_NOPELL_DFLT.modified * CSI6.7$BBRR3_PP_NOPELL_N

noPell.default.rate <- sum(CSI6.7$BBRR3_PP_NOPELL_DFLT_N, na.rm=TRUE) / sum(CSI6.7$BBRR3_PP_NOPELL_N, na.rm=TRUE) 
paste("The share of non-Pell parents who default is ", percent(noPell.default.rate, accuracy=0.1)) 
```

```{r stat27, include=TRUE, echo=FALSE, warning=FALSE}
yesPell.default.rate <- sum(CSI6.7$BBRR3_PP_PELL_DFLT_N, na.rm=TRUE) / sum(CSI6.7$BBRR3_PP_PELL_N, na.rm=TRUE) 
paste("The share of Pell parents who default is", percent(yesPell.default.rate, accuracy=0.1)) 
```

## Inside the Lives of Parent-Borrowers

Parents do not take on Parent PLUS loans in a vacuum; these loans are one factor among many that compounds with the racial wealth gap and forces parents to choose between paying their monthly bills, retiring when they want to, purchasing a home, and putting food on the table. Prior research has found that nearly 40 percent of older borrowers, most of whom owe for their children’s education, even go so far as to skip meeting their own health care needs, compared to 25 percent of non-borrowers their age. If we are to understand how the Parent PLUS program impacts different families differently, we must understand parents’ financial circumstances. 

Other than when parents complete applications for financial aid, their information is not often surveyed by the U.S. Department of Education, making in-depth data on parent-borrowers scarce. One place to find such data is the Survey of Household Economics and Decisionmaking, an annual survey conducted by the Federal Reserve. The survey asks households whether they hold student loans for a child’s education, which can include private loans; Parent PLUS borrowers likely comprise a large majority of this sample. 

The data paint a stark study in contrasts: along numerous dimensions, Black and Latino/a parent-borrowers face greater barriers to financial wellbeing, and thus greater barriers to repayment, than do white parent-borrowers. (For the full set of results, see Appendix 2.) 

```{r note4, include=TRUE, echo=FALSE, warning=FALSE}
# For the R Markdown file for the SHED analysis, located in the GitHub repository for this report. 
```

* Income: The median white parent who holds these loans earns more than $100,000 a year combined with their spouse or partner, versus $50,000 to $75,000 for Black parent-borrowers and $75,000 to $100,000 for Latino/a parent-borrowers. Around 35 percent of the Black and Latino/a parents who hold these loans earn under $50,000, combined with their spouse or partner, which is double the rate for white parents who hold these loans (17 percent). (See Figure 5; note that these calculations exclude households where the respondent is a retiree.) 

* Savings: Half of white parents who hold these loans have household savings and investments exceeding $100,000. Only a quarter of Black and Latino/a parents with these loans have that much in household savings and investments. 

* Home ownership: Among those with student loans for a child’s education, 90 percent of white parents own a home, compared to 69 percent of Black parents and 82 percent of Latino/a parents.

* Educational attainment: More than half of Latino/a parents who hold these loans have only a high school diploma or lower level of education. About one-third of Black parents who hold these loans have only a high school diploma or lower level of education, and one-quarter of white parents who hold these loans have a high school diploma or lower level of education. 

* Debt for their own education: Many more Black parents (33 percent) and Latino/a parents (29 percent) who hold these loans for their children’s education also hold student loans or other debt for their own education, compared to white parents (13 percent) who hold these loans. 

* Other high-interest debt for education: High-interest credit card debt is more frequently a component of overall education debt for Latino/a parents (29 percent) and Black parents (22 percent) than white parents (14 percent). 

* Repayment ability: 37 percent of Black parents say they expect to be unable to make a partial payment on their student loan bills in the month they are surveyed, compared to roughly 20 percent for all other groups. 
* Financial security: When respondents are asked if they could get by without their primary income for three months, more than one-half of white parents with these loans said “yes” compared to around 36 percent of Black and Latino/a parents with these loans.  

Figure 5. PARENT PLUS BORROWERS HOUSEHOLD INCOME, BY RACE/ETHNICITY

```{r note5, include=TRUE, echo=FALSE, warning=FALSE}
# For the code that produced this figure, see the R Markdown file for the SHED analysis, located in the GitHub repository for this report. 
```

These results help us understand why repayment is so low: Parent PLUS loans compound disparities in income, education, assets, other debt, and more. The parents of students with considerable unmet need who borrow to fund their child’s education are also the ones likely to face numerous barriers to repayment. 

There are also financial challenges not captured in the survey data analyzed above. In particular, Black workers experience well-documented discrimination in the employment market, which has a downward impact on income and savings. Moreover, Black college graduates are more often relied upon by immediate and extended family for assistance meeting basic needs, which means that even for Black parent-borrowers who went to college themselves, the limited resources they need to pay their monthly Parent PLUS bills are pulled from all directions. And the same is likely true of many who do not have the benefit of a degree.

### The Worst Outcomes of All: Social Security Offsets 

When a student loan borrower defaults on their loan, they may have their income withheld from them in the form of wage garnishment and tax refund withholding. This applies to Social Security payments as well, and in 2015, the Department of Education collected $171 million in student loan payments through offsets to Social Security. Although this does not affect most younger borrowers, Parent PLUS borrowers comprise an outsized share of those who are subject to this offsetting. Whereas Parent PLUS makes up about one in fourteen of all outstanding federal student loans, the Government Accountability Office (GAO) reports that one in three of the retirement-aged borrowers whose Social Security payments are offset had a Parent PLUS loan at some point in time. 

This is not a case of borrowers simply forgetting to pay their monthly bill: five years after the offset, one-third of older borrowers were still in default. For more than half of those subject to the offset who were over aged 50, none of the offset was applied to the principal, meaning that after retirees or disabled people had their Social Security income reduced, their debt burdens still did not decrease.  

In essence, the offset is a ghastly, counterproductive way for one government agency (the Social Security Administration) to pay the interest on debt held by another (the U.S. Department of Education)—something that seems not only a waste of resources but also counter to both agencies’ missions.

The Government Accountability Office’s research on these borrowers subject to offset, all of whom are either retired or disabled, is a window into both the harsh consequences of student loan default among older borrowers and their difficulty to repay their loans. According to the GAO’s data, of borrowers whose Social Security payments were offset in 2015, 80 percent had held their student loans for at least ten years, 43 percent had held their student loans for at least twenty years, and 11 percent had held their loans for at least thirty years. This is to say that one in nine of those who saw their Social Security benefits offset in 2015 had held the loan since 1985, or even earlier. 

Increasingly, these offsets result in monthly Social Security payments that were reduced to amounts below the poverty guideline. Among student loan borrowers subject to the offset in 2004, 42 percent of monthly payments were less than the poverty guideline, and this increased to 69 percent by 2015. 

While disaggregation by race was not provided in the GAO’s report, inferring from the data on repayment presented above suggests that these borrowers subject to Social Security offset are likely disproportionately Black or Latino/a. Not only might a parent-borrower delay retirement to keep paying their student loan bills, but even after they do retire, they may have to live in poverty if they default and have no other income sources. While Parent PLUS loans are automatically forgiven when a borrower passes away, it is a disgrace that a parent might live out their last years in poverty because they wanted their child to get a college education. 

## How Did We Get Here? 

Being a parent is, for many people, the most important thing they do in their lifetime. Some call it their vocation, their calling. Parents want their children to have a better life than they had, and even to achieve their dreams, which often includes attending college. And given how hard high school students work to get into these colleges—in one study, 49 percent of juniors at private high schools reported “a great deal of stress on a daily basis,” with preparing for college listed as a top reason why—parents do not want anything to stand in their way, even the reality of what they can reasonably afford. And it remains true that the only thing more expensive than a college degree is not getting a college degree.

Perhaps it is not surprising, then, that more than a million parents every year use Parent PLUS loans to stake their own financial future to provide for their children’s educational opportunities. But it is critical to examine why they would need to do this, and why this phenomenon seems to occur far more within communities of color. 

The data presented in this report is precisely what should be expected to happen when these three things are true:

1. Parents know their child will be at a disadvantage if they lack a college degree. 

2. These parents must cover an outsized share of costs as a result of disinvestment at the state and federal level, including reduced funding to public institutions and the decline of the Pell Grant’s purchasing power. 
3. As a product of our nation’s history and generations of policy, some families have significantly more resources than do others, correlated by race. 

During the rise in use of Parent PLUS loans, the federal government, the colleges, and the parents were all making well-intentioned choices in the service of college opportunity. The federal government made the loans available at rates that were generally better than what parents could obtain through the private market. The colleges, for their part, informed the families of this program. And the parents took out the loans due to a desire to set their children up for success, whatever it would take. 

But noble intentions can be beset by unforeseen circumstances. Parent PLUS has run headlong into a runaway train: state lawmakers’ decades-long campaign of disinvestment from public higher education. In 1980, when the Parent PLUS program was created, average tuition and fees at a public four-year college was $2,387 (in current dollars). Today, it stands more than four times higher, at $9,349, the result of state funding cuts made during recessions never being undone, one economic cycle after another. 

It is hardly a coincidence, then, that Parent PLUS borrowing at public four-year colleges is greatest in the states that provide the lowest levels of funding to four-year education. (See Figure 6.) Moreover, Parent PLUS itself may have created an implicit permission structure whereby states could shift the cost burden more to parents, knowing that there is a limitless stream of liquidity that can fill in the gaps. And a greater share of costs borne by families has a disproportionate impact on those with less income and wealth, making the intersection with the racial wealth gap so damaging. 

Figure 6: PERCENTAGE OF STUDENTS RECEIVING PARENT PLUS TO ATTEND PUBLIC COLLEGES VERSUS STATE EDUCATION APPROPRIATIONS PER FTE STUDENT

```{r figure6, include=TRUE, echo=FALSE, warning=FALSE}
#########################################################
### This chunk plots data from two sources. The first ###
### is the share of undergraduates at public four-    ###
### years who received Parent PLUS in 2017-18, by     ###
### state. These data come from NPSAS:18-AC, using    ###
### Powerstats table xngvmz.                          ###
### The second source is SHEEO's dataset for the      ###
### State Higher Education Finance reports, available ###
### at https://shef.sheeo.org/data-downloads/. We use ###
### the state-by-state data on four-year education    ###
### appropriations per FTE.                           ###
#########################################################

statePLUS <- read.csv("PLUS by State.csv", header=TRUE)
stateApprops <- read.csv("Approps by State.csv", header=TRUE)
states <- left_join(x=statePLUS, y=stateApprops, by="State")
ggplot(data=states, mapping=aes(x=Four.Year.Education.Appropriations.per.FTE, y=Percent)) + geom_point() + geom_smooth(method=lm, se=FALSE) + labs(x="Four-year education appropriations per FTE", y="Percent of public four-year students receiving Parent PLUS") + scale_y_continuous(labels=scales::percent_format()) + scale_x_continuous(labels=scales::dollar_format()) 
```

Consider, as well, how economic forces have changed the prototypical American family. It used to be the case that, in most U.S. families, one spouse worked while the other was out of the workforce, raising their children. Parent PLUS makes the most sense for that dual-parent, one-income household, which can increase its income during the repayment period by having the second spouse enter the workforce when the proverbial nest is empty. Over the decades, however, that family has been disappearing. In 1980, when Parent PLUS was established, 47 percent of married two-parent families with children 18 or under had only one spouse in the workforce. In 2019, that figure was 30 percent.

```{r stat28, include=TRUE, echo=FALSE, warning=FALSE}
#################################################################
### This is an analysis of data from the Panel Study of       ###
### Income Dynamics, available at                             ###
### https://simba.isr.umich.edu/data/data.aspx.               ###
### We use a dataset that was generated through a custom      ###
### query. A couple variables that were drawn in the query    ###
### are not needed, so please ignore those. 

#################################################################
### First we load in the data from the PSID.                  ###
#################################################################

PSID <- read.csv("J305313.csv", header=TRUE)
names(PSID) <- c("Release number 1980", 
                 "Interview Number 1980", 
                 "Age of youngest child 1980", 
                 "Head employment status 1980", # We would like to know about 
                 # what you do--are you (HEAD) working now, looking for work, 
                 # retired, a student, (a housewife), or what?
                 "Spouse employment status 1980", # We would like to know about 
                 # what your (Wife/friend) does--is she working now, looking for 
                 # work, retired, a housewife, or what?
                 "Marital status 1980", # Are you married, single, widowed, 
                 # divorced, or separated?
                 "Family weight 1980",
                 "Release Number 2019",
                 "Interview Number 2019", 
                 "Age of youngest child 2019", 
                 "Marital status 2019", # Are (you/Reference Person) married, 
                 # widowed, divorced, separated, or have you never been married?
                 "Head employment status 2019", #  We would like to know about 
                 # what (you do/Reference Person does) -- (are you/is Reference 
                 # Person) working now, looking for work, retired, keeping 
                 # house, a student, or what?
                 "Spouse employment status 2019", # We would like to know about
                 # what (you do/[Spouse/Partner] does)--(are you/is 
                 # [Spouse/Partner]) working now, looking for work, retired, 
                 # keeping house, a student, or what?
                 "Family weight 2019"
                 )

#################################################################
### Now we separate the dataset into two based on year.       ###
#################################################################

# Total PSID file: 14,973 files 
PSID1980 <- PSID %>% filter(is.na(`Family weight 1980`)==FALSE) # 6,533
PSID2019 <- PSID %>% filter(is.na(`Family weight 2019`)==FALSE) # 9,569

###################################################################
### Next we filter for married families with children under 18. ###
###################################################################

PSID1980.married.withKids <- PSID1980 %>% filter(`Marital status 1980` == 1) %>% filter(`Age of youngest child 1980` %in% c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18)) # 2,419
PSID2019.married.withKids <- PSID2019 %>% filter(`Marital status 2019` == 1) %>% filter(`Age of youngest child 2019` %in% c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18)) # 2,010 

#################################################################
### Now we assign variables to tell us whether the spouses    ###
### in the workforce, and we mark when a family is a one-     ###
### breadwinner household.                                    ###
#################################################################

PSID1980.married.withKids$Spouse1Workforce <- ifelse(PSID1980.married.withKids$`Head employment status 1980` %in% c(1, 2, 3), 1, 0)
PSID1980.married.withKids$Spouse2Workforce <- ifelse(PSID1980.married.withKids$`Spouse employment status 1980` %in% c(1, 2, 3), 1, 0)
PSID2019.married.withKids$Spouse1Workforce <- ifelse(PSID2019.married.withKids$`Head employment status 2019` %in% c(1, 2, 3), 1, 0)
PSID2019.married.withKids$Spouse2Workforce <- ifelse(PSID2019.married.withKids$`Spouse employment status 2019` %in% c(1, 2, 3), 1, 0)

PSID1980.married.withKids$OneBreadwinner <- ifelse(PSID1980.married.withKids$Spouse1Workforce + PSID1980.married.withKids$Spouse2Workforce == 1, 1, 0)
PSID2019.married.withKids$OneBreadwinner <- ifelse(PSID2019.married.withKids$Spouse1Workforce + PSID2019.married.withKids$Spouse2Workforce == 1, 1, 0)

#################################################################
### Now we aggregate these two sets of data and we calculate  ###
### the percentage of married households with children that   ###
### have just one breadwinner.                                ###
#################################################################

tblP1 <- aggregate(data=PSID1980.married.withKids, `Family weight 1980` ~ OneBreadwinner, FUN=sum)
tblP1$Year <- rep("1980", nrow(tblP1))
tblP2 <- aggregate(data=PSID2019.married.withKids, `Family weight 2019` ~ OneBreadwinner, FUN=sum)
tblP2$Year <- rep("2019", nrow(tblP2))
tblP <- full_join(x=tblP1, y=tblP2, by="OneBreadwinner")
paste("The share of married-with-children families in 1980 that had only one breadwinner was", percent(tblP$`Family weight 1980`[tblP$OneBreadwinner==1] / (tblP$`Family weight 1980`[tblP$OneBreadwinner==1] + tblP$`Family weight 1980`[tblP$OneBreadwinner==0]), accuracy=0.1)) 
```

```{r stat29, include=TRUE, echo=FALSE, warning=FALSE}
paste("The share of married-with-children families in 2019 that had only one breadwinner was", percent(tblP$`Family weight 2019`[tblP$OneBreadwinner==1] / (tblP$`Family weight 2019`[tblP$OneBreadwinner==1] + tblP$`Family weight 2019`[tblP$OneBreadwinner==0]), accuracy=0.1)) 
```

Unfortunately, parents’ determination to enroll their children at their desired college is not matched by a determination in Congress to enable such enrollment to be done affordably. When the Parent PLUS program was created, the Pell Grant’s share of the average costs of tuition, fees, room, and board at public four-year colleges had recently peaked at 79 percent; today, it has fallen to around 29 percent.

By providing Parent PLUS at relatively high interest rates and fewer options to reduce monthly payments, it is as if the federal government is standing in the desert selling water bottles for $100 apiece. Tragically, willing customers are lined up for miles. 

## A Reckoning Over Parent PLUS Is Overdue

Higher education’s dependency on Parent PLUS cannot continue. If current trends persist, then members of the Millennial, Gen Z, and subsequent generations may spend their entire adult lives in student loan repayment, combined between their own student loans and those for their children. 

In order to reduce harmful and counterproductive Social Security offsets, high rates of default among vulnerable families, and the continued worsening of the racial wealth gap, policymakers in Congress, the White House, and the Department of Education should confront the fact that the Parent PLUS program has become something far different from what it was conceived to be. 

### Parent PLUS Reform Should Be Accompanied by Additional Resources

Some have proposed reducing the number of families that can take out Parent PLUS loans through stricter assessments of a family’s ability to repay the loans. This is one of the most clear pathways to reducing Parent PLUS defaults, but it also means that low-income families, disproportionately Black families, may be driven to the private loan market instead, where loan terms will be even less favorable to families. Many of these families, especially those living in places without access to an affordable community college or public four-year education, would not enroll their children in college at all, due to their lack of financial resources. 

Some of these reforms may be necessary, but if they are enacted, they should be accompanied by deliberate policy efforts to replace any lost Parent PLUS loan resources with grant aid. The concern over harmful impacts of any Parent PLUS reform is greatest at HBCUs, where an earlier reform—a change to how the Department of Education checks Parent PLUS borrowers’ credit histories in the early 2010s—threw HBCUs into a state of financial distress that the president of Hampton University called “the worst situation I’ve seen in 35 years.” Should similar policy changes be undertaken in the future, a financial safety net must be in place for the institutions and families that have relied on Parent PLUS the most. 

### The Biden Administration Should Include Parent PLUS in Any Executive Action on Student Loan Forgiveness

In recent weeks, the Biden administration has indicated that it is exploring executive action on student debt cancellation. This would mark the most significant relief for student loan borrowers in history, though at a budgetary cost over time. The elimination of up to $50,000 per borrower would cost roughly $1 trillion, and the proposal to eliminate $10,000 per borrower would cost an estimated $373 billion. Facing political pressure to limit the budgetary impact of this executive action, the Biden administration may consider targeting this forgiveness to certain categories of borrowers, such as how the president has mentioned targeting forgiveness at those who attended public institutions. 

To this end, the administration may consider excluding Parent PLUS from executive action on forgiveness, taking a “per student” approach rather than a “per borrower” approach. Some may argue that including Parent PLUS would mean one family can benefit twice as much from the executive action as another family simply because of how they distributed their loan burden between parent and child, which may have been an arbitrary decision. And, unfortunately, the administration may feel less pressure to include parent-borrowers because they are not who the body politic thinks of as struggling student loan borrowers.  

But the administration should include Parent PLUS in executive action on forgiveness. The analysis presented in this report illustrates the difficulties parents face in repayment and how these increased loans likely resulted from reduced public funding for higher education. And we have seen how the racial wealth gap makes Parent PLUS repayment a profoundly different experience for Black and Latino/a parents versus white parents, and for low-wealth parents versus rich parents. 

One-time cancellation of Parent PLUS debt may bring profound improvements to financial freedom for some parents, with impacts that last for twenty years or more. And the fact that income-based repayment (IBR) is unavailable to Parent PLUS borrowers makes it all the more likely that cancellation would newly provide low-income parent-borrowers a way out from having to make monthly payments, more so than for other low-income borrowers. 

Determining the proper amount to forgive is outside the scope of this report. But the scale of the student debt problem is so large that some action must be taken while the political will exists. Even a smaller amount of forgiveness per borrower would be life-changing for many. For example, most of the student loan borrowers subject to Social Security offsets owed less than $10,000 at the time of the initial offset. 

Consider that the Congressional Budget Office (CBO) has found that the Parent PLUS program turns a profit for the federal government, and under one of the CBO’s two projection methodologies, it is the only federal student loan program expected to take in more money over the coming years than it gives out. This is to say that higher interest rates for Parent PLUS, combined with Parent PLUS borrowers’ inability to access IBR, have been helping to finance the federal subsidy provided by other undergraduate loans. Perhaps this ongoing redistribution of resources from parent-borrowers to other borrowers would be acceptable if all parent-borrowers were high-income and financially secure. But that is simply not what the data tell us. 

These parents cannot be kept on the fringes of the policy debate. The cancellation of student debt, including and especially Parent PLUS loans, is one vital step toward correcting the ills of racial inequality in the United States and enabling many of these borrowers to regain their financial footing and once again become full participants in the economy. Parent PLUS must be included in debt cancellation. 

```{r hiddenstat, include=FALSE, echo=FALSE, warning=FALSE}
#################################################################
### These stats were included in the press release for this   ###
### report but not the report itself.                         ###
#################################################################

sfa1920 <- fread("sfa1920.csv", header=TRUE, select=c(
  "UNITID",   # Unique identification number of the institution
  "SCUGRAD",  # Total number of undergraduates - financial aid cohort
  "UPGRNTN"   # Number of undergraduate students awarded Pell grants
))
sfa1920$SCUGRAD <- as.numeric(sfa1920$SCUGRAD)
sfa1920$UPGRNTN <- as.numeric(sfa1920$UPGRNTN)
sfa1920 <- sfa1920 %>% filter(is.na(SCUGRAD)==FALSE
                              & is.na(UPGRNTN)==FALSE)
hd2020 <- fread("hd2020.csv", header=TRUE, select=c(
  "UNITID", 
  "HBCU", 
  "CONTROL"
))
sfa1920 <- inner_join(x=sfa1920, y=hd2020, by="UNITID")
tbl26A <- aggregate(data=sfa1920, cbind(SCUGRAD, UPGRNTN) ~ CONTROL, FUN=sum)
tbl26B <- aggregate(data=sfa1920, cbind(SCUGRAD, UPGRNTN) ~ HBCU, FUN=sum)
tbl26A$`Share who receive Pell` <- tbl26A$UPGRNTN / tbl26A$SCUGRAD
tbl26B$`Share who receive Pell` <- tbl26B$UPGRNTN / tbl26B$SCUGRAD

tbl26A
tbl26B
```
